<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>ShaoDJ's World - DJ.shao</title><link href="https://shaodongjun.github.io/" rel="alternate"></link><link href="https://shaodongjun.github.io/feeds/djshao.atom.xml" rel="self"></link><id>https://shaodongjun.github.io/</id><updated>2025-03-22T17:18:00+08:00</updated><entry><title>ä¸€ä¸ªè¡Œæç®±éšæ—¶è·‘è·¯ï¼šæç®€ç‰©å“æ¸…å•</title><link href="https://shaodongjun.github.io/posts/2025/03/22/Minimalist-living-box-for-travel/" rel="alternate"></link><published>2025-03-22T17:18:00+08:00</published><updated>2025-03-22T17:18:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-03-22:/posts/2025/03/22/Minimalist-living-box-for-travel/</id><summary type="html">&lt;h2&gt;ä¸ºä»€ä¹ˆåˆ—æç®€ç‰©å“æ¸…å•ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å‡å¦‚æˆ‘è¦æ¯3ä¸ªæœˆæ¢ä¸€ä¸ªåœ°æ–¹ç”Ÿæ´»ï¼Œ&amp;nbsp;æ‰€ä»¥æˆ‘æ‰“ç®—å¤´è„‘é£æš´ä¸€ä¸‹ï¼Œåœ¨æç«¯çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªäººè¦ç»´æŒåŠå¹´çš„ç”Ÿæ´»ï¼Œæ‰€éœ€è¦çš„æœ€ â€¦&lt;/p&gt;</summary><content type="html">&lt;h2&gt;ä¸ºä»€ä¹ˆåˆ—æç®€ç‰©å“æ¸…å•ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å‡å¦‚æˆ‘è¦æ¯3ä¸ªæœˆæ¢ä¸€ä¸ªåœ°æ–¹ç”Ÿæ´»ï¼Œ&amp;nbsp;æ‰€ä»¥æˆ‘æ‰“ç®—å¤´è„‘é£æš´ä¸€ä¸‹ï¼Œåœ¨æç«¯çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªäººè¦ç»´æŒåŠå¹´çš„ç”Ÿæ´»ï¼Œæ‰€éœ€è¦çš„æœ€å°‘ç‰©å“æ˜¯å¤šå°‘å‘¢ï¼Ÿ&lt;/p&gt;
&lt;h2&gt;æˆ‘çš„å¿…è¦æ¸…å•&lt;/h2&gt;
&lt;p&gt;&lt;font color=red size=+1&gt;èº«ä»½è¯ã€æ‰‹æœºã€é’¥åŒ™ã€é’± &lt;/font&gt;&lt;/p&gt;
&lt;p&gt;åˆ†ä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;è¡£ç‰©é‹åŒ…ï¼ˆè¡£æœã€é‹å­ã€åŒ…åŒ…ã€‚ï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”µå­äº§å“&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ—¥åŒ–ç”¨å“&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;æç®€è¡£ç‰©&amp;nbsp;10&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¤å­£Tæ¤+é€Ÿå¹²å†…è¡£è£¤+é˜²æ™’è¡£&lt;/li&gt;
&lt;li&gt;ç§‹å­£é•¿è¢–+é©¬ç”²+ç‰›ä»”è£¤+é£è¡£&lt;/li&gt;
&lt;li&gt;å†¬å­£æŠ“ç»’è¡«+å†²é”‹è¡£+ç¾½ç»’æœ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¿æš–è¦†ç›–åˆ°é›¶ä¸‹10åº¦å³å¯ã€‚ &lt;/p&gt;
&lt;h3&gt;æç®€åŒ…åŒ…&amp;nbsp;3&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åŒè‚©åŒ… 1&amp;nbsp;ä¸ª&lt;/li&gt;
&lt;li&gt;æ–œæŒåŒ… 1&amp;nbsp;ä¸ª&lt;/li&gt;
&lt;li&gt;æ£’çƒå¸½ 1&amp;nbsp;ä¸ª&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;æç®€é‹å­&amp;nbsp;4&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å‡‰é‹ 1&amp;nbsp;åŒ&lt;/li&gt;
&lt;li&gt;è¿åŠ¨é‹ / ä¼‘é—²é‹ï¼ˆå¦‚å¸†å¸ƒã€æ¿é‹ä¹‹ç±»çš„ï¼‰ 1&amp;nbsp;åŒ&lt;/li&gt;
&lt;li&gt;é´å­ 1&amp;nbsp;åŒï¼ˆé˜²æ°´ï¼Œé›¨å¤©å¿…å¤‡ï¼‰&lt;/li&gt;
&lt;li&gt;å†¬å­£åŠ ç»’é´å­ 1&amp;nbsp;åŒï¼ˆé˜²æ°´ï¼Œä¸æ€•é›¨é›ªæ³¥æ³ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;æç®€æŠ¤è‚¤å’ŒåŒ–å¦†&amp;nbsp;6&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ´—é¢å¥¶&lt;/li&gt;
&lt;li&gt;ä¿æ¹¿éœœ&lt;/li&gt;
&lt;li&gt;æ²æµ´éœ²&lt;/li&gt;
&lt;li&gt;æ´—å‘æ°´&lt;/li&gt;
&lt;li&gt;ç‰™è†ç‰™åˆ·&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ç”µå­äº§å“&amp;nbsp;4&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç¬”è®°æœ¬ç”µè„‘ğŸ’» 1&amp;nbsp;å°ï¼ˆåŠå……ç”µçº¿ï¼‰&lt;/li&gt;
&lt;li&gt;æ‰‹æœºğŸ“±ï¼ˆåŠå……ç”µçº¿ï¼‰&lt;/li&gt;
&lt;li&gt;æ™ºèƒ½æ‰‹è¡¨&lt;/li&gt;
&lt;li&gt;è€³æœº 1&amp;nbsp;å‰¯ï¼ˆè“ç‰™æˆ–è€…çº¿æ§è€³æœºï¼Œåªé€‰æ‹©ä¸€ç§ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ç”Ÿæ´»ç‰©å“&amp;nbsp;4&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;1&amp;nbsp;æŠŠä¼&lt;/li&gt;
&lt;li&gt;1&amp;nbsp;ä¸ªä¾¿æºæ°´æ¯&lt;/li&gt;
&lt;li&gt;çœ¼é•œï¼ˆè¿‘è§†é•œï¼Œå¿…å¤‡ï¼‰&lt;/li&gt;
&lt;li&gt;1&amp;nbsp;ä¸ªè¡Œæç®±ï¼ˆè£…ä»¥ä¸Šæ‰€æœ‰ç‰©å“ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æç®€ä¸»ä¹‰ï¼Œæ˜¯ç²¾å¿ƒæŒ‘é€‰æ¥è§¦ä¹‹ç‰©ã€‚&lt;/p&gt;</content><category term="æ‚è®°"></category><category term="blog"></category><category term="misc"></category><category term="life"></category></entry><entry><title>ä»APIå¼•ç”³åˆ°MCPåè®®</title><link href="https://shaodongjun.github.io/posts/2025/03/14/future-aigc-mcp/" rel="alternate"></link><published>2025-03-14T11:08:00+08:00</published><updated>2025-03-14T11:08:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-03-14:/posts/2025/03/14/future-aigc-mcp/</id><summary type="html">&lt;h1&gt;ä¸‰åˆ†é’Ÿçœ‹æ‡‚MCPç°çŠ¶å’Œæœªæ¥&lt;/h1&gt;
&lt;h2&gt;MCPåè®®è¯¦è§£&lt;/h2&gt;
&lt;p&gt;&lt;span class="caps"&gt;MCP&lt;/span&gt;ï¼ˆModel Context&amp;nbsp;Protocolï¼‰æ˜¯ä¸€ç§æ–°çš„å¼€æ”¾åè®®ï¼Œç›®çš„æ˜¯ä¸ºLLMæä¾›æ ‡å‡†åŒ–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ä¼ é€’æ–¹å¼ï¼Œä»è€Œå®ç°AIæ™ºèƒ½ä½“ä¸å¤–éƒ¨æ•°æ®åŠå·¥å…·çš„ç»“åˆã€‚&lt;/p&gt;
&lt;p&gt;é€šä¿—çš„è¯è®²ï¼ŒMCPå°±åƒæ˜¯ä¸“ä¸ºAIåº”ç”¨è®¾è®¡çš„é€šç”¨æ¥å£ï¼Œç±»ä¼¼æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨çš„USB-Cã€‚&lt;/p&gt;
&lt;p&gt;æ­£å¦‚USB-Cç®€åŒ–äº†ä¸åŒè®¾å¤‡ä¸è®¡ç®—æœºçš„è¿æ¥æ–¹å¼ï¼ŒMCPç®€åŒ–äº†AIæ¨¡å‹ä¸æ•°æ® â€¦&lt;/p&gt;</summary><content type="html">&lt;h1&gt;ä¸‰åˆ†é’Ÿçœ‹æ‡‚MCPç°çŠ¶å’Œæœªæ¥&lt;/h1&gt;
&lt;h2&gt;MCPåè®®è¯¦è§£&lt;/h2&gt;
&lt;p&gt;&lt;span class="caps"&gt;MCP&lt;/span&gt;ï¼ˆModel Context&amp;nbsp;Protocolï¼‰æ˜¯ä¸€ç§æ–°çš„å¼€æ”¾åè®®ï¼Œç›®çš„æ˜¯ä¸ºLLMæä¾›æ ‡å‡†åŒ–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ä¼ é€’æ–¹å¼ï¼Œä»è€Œå®ç°AIæ™ºèƒ½ä½“ä¸å¤–éƒ¨æ•°æ®åŠå·¥å…·çš„ç»“åˆã€‚&lt;/p&gt;
&lt;p&gt;é€šä¿—çš„è¯è®²ï¼ŒMCPå°±åƒæ˜¯ä¸“ä¸ºAIåº”ç”¨è®¾è®¡çš„é€šç”¨æ¥å£ï¼Œç±»ä¼¼æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨çš„USB-Cã€‚&lt;/p&gt;
&lt;p&gt;æ­£å¦‚USB-Cç®€åŒ–äº†ä¸åŒè®¾å¤‡ä¸è®¡ç®—æœºçš„è¿æ¥æ–¹å¼ï¼ŒMCPç®€åŒ–äº†AIæ¨¡å‹ä¸æ•°æ®ã€å·¥å…·å’ŒæœåŠ¡ä¹‹é—´çš„äº¤äº’æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡MCPï¼ŒAIåŠ©æ‰‹ä¸ä»…èƒ½å¤Ÿã€Œè¯»æ‡‚ã€ä»£ç ï¼Œè¿˜èƒ½ã€Œç†è§£ã€å›¢é˜Ÿè®¨è®ºã€æ¶‰åŠæ–‡æ¡£ç­‰å¤–éƒ¨ä¿¡æ¯ï¼Œæä¾›æ›´åŠ ç²¾å‡†çš„å›ç­”ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="mcp archintcture" src="/images/mcp_architecture.png"&gt;&lt;/p&gt;
&lt;h2&gt;MCPåè®®çš„ä¼˜ç‚¹&lt;/h2&gt;
&lt;p&gt;MCPæ˜¯ä¸€ç§æ ‡å‡†åŒ–åè®®ï¼Œç”¨äºè¿æ¥AIæ™ºèƒ½ä½“ä¸å„ç§å¤–éƒ¨å·¥å…·å’Œæ•°æ®æºã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸»è¦ä¼˜åŠ¿å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å¼€å‘ç®€åŒ–ï¼šä¸€æ¬¡ç¼–å†™ï¼Œå¤šæ¬¡é›†æˆï¼Œæ— éœ€ä¸ºæ¯ä¸ªæ–°é›†æˆé‡å†™å®šåˆ¶ä»£ç &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;çµæ´»æ€§ï¼šåˆ‡æ¢AIæ¨¡å‹æˆ–å·¥å…·æ—¶ï¼Œä¸éœ€è¦å¤æ‚çš„é‡æ–°é…ç½®&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å®æ—¶å“åº”ï¼šMCPè¿æ¥ä¿æŒæ´»è·ƒçŠ¶æ€ï¼Œæ”¯æŒå®æ—¶ä¸Šä¸‹æ–‡æ›´æ–°å’Œäº¤äº’&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å®‰å…¨æ€§å’Œåˆè§„æ€§ï¼šå†…ç½®è®¿é—®æ§åˆ¶æœºåˆ¶å’Œæ ‡å‡†åŒ–çš„å®‰å…¨å®è·µ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯æ‰©å±•æ€§ï¼šéšç€AIç”Ÿæ€ç³»ç»Ÿçš„æ‰©å±•ï¼Œåªéœ€è¿æ¥æ–°çš„MCPæœåŠ¡å™¨å³å¯è½»æ¾æ·»åŠ æ–°åŠŸèƒ½&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨æ²¡æœ‰MCPä¹‹å‰ï¼ŒAIåŠ©æ‰‹è¦æƒ³ä¸å¤–éƒ¨å·¥å…·äº’åŠ¨ï¼Œå¿…é¡»é€šè¿‡ç¼–å†™ä»£ç å¹¶è°ƒç”¨APIï¼Œè¿™æ„å‘³ç€æ¯ä¸€ç§å…·ä½“çš„è¿æ¥éƒ½éœ€è¦æå‰æ‰‹åŠ¨ç¼–ç¨‹ï¼Œæ•ˆç‡ä½ä¸‹ä¸”è€—æ—¶è´¹åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;æ›´æ£˜æ‰‹çš„æ˜¯ï¼Œæ¯ä¸ªAIåŠ©æ‰‹ä¸æ¯ä¸ªå¤–éƒ¨å·¥å…·ä¹‹é—´éƒ½éœ€è¦å•ç‹¬è¿›è¡Œé…ç½®ã€‚å¦‚æœæœ‰1000ä¸ªAIåŠ©æ‰‹å’Œ1000ä¸ªå¤–éƒ¨å·¥å…·ï¼Œç†è®ºä¸Šéœ€è¦ç¼–å†™1000Ã—1000=100ä¸‡ä¸ªç‹¬ç«‹çš„è¿æ¥ä»£ç ï¼Œå·¥ä½œé‡ç®€ç›´æ˜¯ä¸ªå¤©æ–‡æ•°å­—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;font color=red&gt;åœ¨MCPæ¨¡å¼ä¸‹ï¼Œæ¯æ–¹åªéœ€å®ç°ä¸€æ¬¡åè®®ï¼Œæ€»å…±åªéœ€2åƒæ¬¡é…ç½®ã€‚è¿™ç›´æ¥ä½¿é…ç½®æ•ˆç‡æé«˜äº†ä¸æ­¢ä¸€ä¸ªç»´åº¦ã€‚&lt;/font&gt;&lt;/p&gt;
&lt;p&gt;MCPçš„çµæ´»æ€§ä¹Ÿéå¸¸çªå‡ºï¼Œå®ƒæ—¢å¯ä»¥åœ¨äº‘ç«¯è¿è¡Œï¼Œä¹Ÿå¯ä»¥åœ¨æœ¬åœ°è®¾å¤‡ä¸Šéƒ¨ç½²ï¼Œé€‚åº”æ€§æå¼ºã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥è¯´ï¼ŒMCPå°±åƒä¸ºAIåŠ©æ‰‹å’Œå¤–éƒ¨ç³»ç»Ÿä¹‹é—´æ¶è®¾äº†ä¸€æ¡é«˜é€Ÿè·¯ï¼Œå–ä»£äº†è¿‡å»éœ€è¦æŠ€æœ¯äººå‘˜ä¸€æ¡¥ä¸€æ¡¥æ‰‹å·¥æ­å»ºçš„ä½æ•ˆæ¨¡å¼ã€‚&lt;/p&gt;
&lt;p&gt;å’Œä¼ ç»Ÿçš„APIç›¸æ¯”ï¼ŒMCPçš„åŒºåˆ«åœ¨äºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å•ä¸€åè®®ï¼šMCPä½œä¸ºä¸€ç§æ ‡å‡†åŒ–çš„ã€Œé€šç”¨æ¥å£ã€ï¼Œé›†æˆä¸€ä¸ªMCPæ„å‘³ç€å¯ä»¥è®¿é—®å¤šä¸ªå·¥å…·å’ŒæœåŠ¡ï¼Œè€Œä¸ä»…ä»…æ˜¯å•ä¸€æœåŠ¡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åŠ¨æ€å‘ç°ï¼šMCPå…è®¸AIæ¨¡å‹åŠ¨æ€å‘ç°å¹¶ä¸å¯ç”¨å·¥å…·äº¤äº’ï¼Œæ— éœ€é¢„å…ˆè®¾å®šæ¯ä¸ªé›†æˆçš„å›ºå®šä»£ç ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åŒå‘é€šä¿¡ï¼šMCPæ”¯æŒæŒç»­ã€å®æ—¶çš„åŒå‘é€šä¿¡â€”â€”ç±»ä¼¼äºWebSocketsã€‚AIæ¨¡å‹æ—¢å¯ä»¥è·å–ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥å®æ—¶è§¦å‘æ“ä½œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶ä¸­ï¼Œå®æ—¶åŒå‘é€šä¿¡çš„æœºåˆ¶å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ‹‰å–æ•°æ®ï¼šLLMå‘æœåŠ¡å™¨æŸ¥è¯¢ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼ŒæŸ¥çœ‹ä½ çš„æ—¥å†å®‰æ’ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è§¦å‘æ“ä½œï¼šLLMæŒ‡ç¤ºæœåŠ¡å™¨æ‰§è¡Œå…·ä½“æ“ä½œã€‚ä¾‹å¦‚ï¼Œé‡æ–°å®‰æ’ä¼šè®®ã€å‘é€ç”µå­é‚®ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;MCPç³»ç»Ÿæ¶æ„&lt;/h2&gt;
&lt;p&gt;MCPé‡‡ç”¨ç®€å•çš„å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¶æ„æ¨¡å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;MCPä¸»æœºï¼šéœ€è¦è®¿é—®å¤–éƒ¨æ•°æ®æˆ–å·¥å…·çš„åº”ç”¨ç¨‹åºï¼ˆå¦‚Claude&amp;nbsp;Desktopæˆ–AIé©±åŠ¨çš„é›†æˆå¼€å‘ç¯å¢ƒï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;MCPå®¢æˆ·ç«¯ï¼šä¸MCPæœåŠ¡å™¨ç»´æŒä¸“å±çš„ä¸€å¯¹ä¸€è¿æ¥&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;MCPæœåŠ¡å™¨ï¼šè½»é‡çº§æœåŠ¡å™¨ï¼Œé€šè¿‡MCPåè®®æä¾›ç‰¹å®šåŠŸèƒ½ï¼Œè¿æ¥åˆ°æœ¬åœ°æˆ–è¿œç¨‹æ•°æ®æº&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æœ¬åœ°æ•°æ®æºï¼šMCPæœåŠ¡å™¨å®‰å…¨è®¿é—®çš„æ–‡ä»¶ã€æ•°æ®åº“æˆ–æœåŠ¡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¿œç¨‹æœåŠ¡ï¼šMCPæœåŠ¡å™¨è®¿é—®çš„åŸºäºäº’è”ç½‘çš„å¤–éƒ¨APIæˆ–æœåŠ¡&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å°†MCPæ¯”ä½œä¸€åº§æ¡¥æ¢å¯ä»¥æ›´æ¸…æ™°åœ°ç†è§£ï¼šMCPæœ¬èº«ä¸å¤„ç†å¤æ‚é€»è¾‘ï¼›å®ƒåªæ˜¯åè°ƒAIæ¨¡å‹å’Œå„ç§å·¥å…·ä¹‹é—´çš„æ•°æ®å’ŒæŒ‡ä»¤æµé€šã€‚
&lt;img alt="mcp server and client" src="/images/mcp_server_arch.png"&gt;&lt;/p&gt;
&lt;h2&gt;MCPçš„æœªæ¥&lt;/h2&gt;
&lt;p&gt;ä¸ç®¡æ˜¯ä½¿ç”¨ &lt;span class="caps"&gt;XML&lt;/span&gt; è¿˜æ˜¯ &lt;span class="caps"&gt;JSON&lt;/span&gt;ï¼Œä¸ç®¡æ˜¯æœ¬åœ°äºŒè¿›åˆ¶ä¸­å¯»æ‰¾ symbol è¿˜æ˜¯é€šè¿‡ &lt;span class="caps"&gt;HTTP&lt;/span&gt; è¿›è¡Œäº¤æ¢ï¼Œæˆ‘ä»¬ä¸€è·¯èµ°æ¥ï¼Œæ—©å·²ä¹ æƒ¯äº†ä½¿ç”¨ç»“æ„åŒ–çš„æ•°æ®æ ¼å¼å’Œé¢„å…ˆå®šä¹‰çš„ &lt;span class="caps"&gt;API&lt;/span&gt; å®Œæˆå„ç§ä»»åŠ¡ã€‚åœ¨ &lt;span class="caps"&gt;API&lt;/span&gt;&amp;nbsp;çš„è°ƒç”¨æ–¹å’Œæä¾›æ–¹ï¼Œéƒ½éœ€è¦äººå·¥ç»´æŠ¤åŠç¨³å®šçš„æ¥å£å¥‘çº¦æ¥è§„å®šå‚æ•°ç±»å‹ã€æ ¼å¼ã€è°ƒç”¨æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;éšç€ &lt;span class="caps"&gt;LLM&lt;/span&gt; å’Œ &lt;span class="caps"&gt;AI&lt;/span&gt; æ—¶ä»£çš„åˆ°æ¥ï¼Œæ— è®ºæ˜¯ function calling è¿˜æ˜¯ &lt;span class="caps"&gt;MCP&lt;/span&gt; å®šä¹‰çš„åè®®ï¼Œéƒ½è¿ˆå‡ºäº†æ–°ä¸€æ­¥ï¼š&lt;font color=red&gt;å®ƒä»¬åœ¨ç°æœ‰ &lt;span class="caps"&gt;API&lt;/span&gt; ä¸Šæ–°å¢äº† &lt;span class="caps"&gt;AI&lt;/span&gt; å‹å¥½å±‚ (å¦‚è‡ªç„¶è¯­è¨€ä»£ç†ç«¯ç‚¹)ï¼Œå®ç°äº†å¯¹ä¼ ç»Ÿ &lt;span class="caps"&gt;API&lt;/span&gt; è®¾è®¡çš„æ¸è¿›å¼æ”¹è¿›ã€‚&lt;/font&gt;åœ¨è°ƒç”¨ &lt;span class="caps"&gt;API&lt;/span&gt; æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨è‡ªç„¶è¯­è¨€æè¿°ï¼Œå¹¶äº¤ç”± &lt;span class="caps"&gt;LLM&lt;/span&gt; ä¸ºæˆ‘ä»¬ç”Ÿæˆç»“æ„åŒ–çš„è°ƒç”¨æ–¹æ³•å’Œå‚æ•°ï¼Œä»è€Œç®€åŒ–äº† &lt;span class="caps"&gt;API&lt;/span&gt;&amp;nbsp;ä½¿ç”¨ä¾§çš„è´Ÿæ‹…ã€‚&lt;/p&gt;</content><category term="äººå·¥æ™ºèƒ½"></category><category term="blog"></category><category term="aigc"></category><category term="llm"></category></entry><entry><title>DevOpså·¥ç¨‹å¸ˆæœ€å¸¸ç”¨çš„å¯é‡ç”¨Playbook</title><link href="https://shaodongjun.github.io/posts/2025/02/21/linux-devops-ansible-playbook/" rel="alternate"></link><published>2025-02-21T16:18:00+08:00</published><updated>2025-02-21T16:18:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-02-21:/posts/2025/02/21/linux-devops-ansible-playbook/</id><summary type="html">&lt;p&gt;æœ€é‡è¦å¸¸ç”¨çš„ 7ä¸ª Ansible&amp;nbsp;Playbook&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;ansible&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;playbook&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="n"&gt;lists&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;hosts&lt;/span&gt; &lt;span class="n"&gt;ops&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yaml&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;host=OPK-JUMPS&amp;quot;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h1&gt;1. å®‰è£…å¸¸ç”¨è½¯ä»¶åŒ…çš„&amp;nbsp;Playbook&lt;/h1&gt;
&lt;p&gt;æ­¤ Playbook&amp;nbsp;ç¡®ä¿åœ¨æ‰€æœ‰æœåŠ¡å™¨ä¸Šå®‰è£…å¸¸ç”¨çš„ç³»ç»Ÿå·¥å…·ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;---&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name â€¦&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;æœ€é‡è¦å¸¸ç”¨çš„ 7ä¸ª Ansible&amp;nbsp;Playbook&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;ansible&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;playbook&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="n"&gt;lists&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;hosts&lt;/span&gt; &lt;span class="n"&gt;ops&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yaml&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;host=OPK-JUMPS&amp;quot;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h1&gt;1. å®‰è£…å¸¸ç”¨è½¯ä»¶åŒ…çš„&amp;nbsp;Playbook&lt;/h1&gt;
&lt;p&gt;æ­¤ Playbook&amp;nbsp;ç¡®ä¿åœ¨æ‰€æœ‰æœåŠ¡å™¨ä¸Šå®‰è£…å¸¸ç”¨çš„ç³»ç»Ÿå·¥å…·ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;---&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;å®‰è£…å¸¸ç”¨è½¯ä»¶åŒ…&lt;/span&gt;
  &lt;span class="n"&gt;hosts&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;{{ host }}&amp;quot;&lt;/span&gt;
  &lt;span class="n"&gt;become&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;
  &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;æ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨&lt;/span&gt;
      &lt;span class="n"&gt;package&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;update_cache&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="n"&gt;yes&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;å®‰è£…å¿…å¤‡è½¯ä»¶åŒ…&lt;/span&gt;
      &lt;span class="n"&gt;package&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
          &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;curl&lt;/span&gt;
          &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;vim&lt;/span&gt;
          &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;git&lt;/span&gt;
          &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;unzip&lt;/span&gt;
        &lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;present&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;become: yes: ç¡®ä¿ä»»åŠ¡ä»¥ sudo&amp;nbsp;æƒé™æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;2. ç”¨æˆ·è´¦æˆ·ç®¡ç†çš„&amp;nbsp;Playbook&lt;/h1&gt;
&lt;p&gt;æ­¤ Playbook&amp;nbsp;åˆ›å»ºå…·æœ‰ç‰¹å®šæƒé™çš„ç”¨æˆ·è´¦æˆ·ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;---&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ç®¡ç†ç”¨æˆ·è´¦å·&lt;/span&gt;
  &lt;span class="n"&gt;hosts&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;{{ host }}&amp;quot;&lt;/span&gt;
  &lt;span class="n"&gt;become&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;
  &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;åˆ›å»ºæ–°ç”¨æˆ·&lt;/span&gt;
      &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;devops&lt;/span&gt;
        &lt;span class="n"&gt;shell&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nb"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bash&lt;/span&gt;
        &lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;present&lt;/span&gt;
        &lt;span class="n"&gt;groups&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;wheel&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ä¸ºç”¨æˆ·è®¾ç½®å¯†ç &lt;/span&gt;
      &lt;span class="n"&gt;authorized_key&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;devops&lt;/span&gt;
        &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;{{ lookup(&amp;#39;file&amp;#39;, &amp;#39;/root/.ssh/id_rsa.pub&amp;#39;&amp;#39;&amp;#39;) }}&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;present&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;user æ¨¡å—: åˆ›å»ºæ–°ç”¨æˆ·ï¼ˆâ€˜devopsâ€™ï¼‰å¹¶å°†å…¶åˆ†é…åˆ° â€˜sudoâ€™&amp;nbsp;ç»„ã€‚&lt;/li&gt;
&lt;li&gt;authorized_key æ¨¡å—: æ·»åŠ  &lt;span class="caps"&gt;SSH&lt;/span&gt;&amp;nbsp;å¯†é’¥ä»¥ä¿éšœå®‰å…¨è®¿é—®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;3. é…ç½® Nginx çš„&amp;nbsp;Playbook&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨æ­¤ Playbook å®‰è£…å¹¶é…ç½® Nginx Web&amp;nbsp;æœåŠ¡å™¨ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;---&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;å®‰è£…å¹¶é…ç½®Nginx&lt;/span&gt;
  &lt;span class="n"&gt;hosts&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;{{ host }}&amp;quot;&lt;/span&gt;
  &lt;span class="n"&gt;become&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;
  &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;å®‰è£…Nginx&lt;/span&gt;
      &lt;span class="n"&gt;apt&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;nginx&lt;/span&gt;
        &lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;present&lt;/span&gt;
      &lt;span class="n"&gt;tags&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt;

    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;é‡å¯Nginx&lt;/span&gt;
      &lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;nginx&lt;/span&gt;
        &lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;restarted&lt;/span&gt;
      &lt;span class="n"&gt;tags&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;restart&lt;/span&gt;

    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;é…ç½®proxy_cacheåŠŸèƒ½&lt;/span&gt;
      &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;proxy_cache&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;j2&lt;/span&gt;
        &lt;span class="n"&gt;dest&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;proxy_cache&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;
      &lt;span class="n"&gt;tags&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;

    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;åˆ›å»ºcacheç›®å½•&lt;/span&gt;
      &lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cache&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx_cache&lt;/span&gt;
        &lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;directory&lt;/span&gt;
        &lt;span class="n"&gt;owner&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;
        &lt;span class="n"&gt;group&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;
        &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;0755&amp;#39;&lt;/span&gt;  &lt;span class="c1"&gt;# è®¾ç½®ç›®å½•æƒé™ï¼Œå¯é€‰&lt;/span&gt;
      &lt;span class="n"&gt;tags&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;service æ¨¡å—: ç¡®ä¿ Nginx&amp;nbsp;åœ¨é…ç½®æ›´æ”¹åé‡å¯ã€‚&lt;/li&gt;
&lt;li&gt;template æ¨¡å—: å°† Jinja2&amp;nbsp;æ¨¡æ¿å¤åˆ¶åˆ°æœåŠ¡å™¨ä»¥å®ç°åŠ¨æ€é…ç½®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;proxy_cache_path&lt;span class="w"&gt; &lt;/span&gt;/var/cache/nginx_cache&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;levels&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;:2&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;keys_zone&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;my_cache:100m&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;inactive&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;60m&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;use_temp_path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;off&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;max_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;1g&lt;span class="p"&gt;;&lt;/span&gt;

upstream&lt;span class="w"&gt; &lt;/span&gt;www&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;server&lt;span class="w"&gt; &lt;/span&gt;localhost:80&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;listen&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;server_port&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;default&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;8080&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;}}&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;location&lt;span class="w"&gt; &lt;/span&gt;~&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\.&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;txt&lt;span class="p"&gt;|&lt;/span&gt;psd&lt;span class="p"&gt;|&lt;/span&gt;gif&lt;span class="p"&gt;|&lt;/span&gt;jpg&lt;span class="p"&gt;|&lt;/span&gt;jpeg&lt;span class="p"&gt;|&lt;/span&gt;png&lt;span class="p"&gt;|&lt;/span&gt;ico&lt;span class="p"&gt;|&lt;/span&gt;js&lt;span class="p"&gt;|&lt;/span&gt;css&lt;span class="o"&gt;)&lt;/span&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;proxy_cache&lt;span class="w"&gt; &lt;/span&gt;my_cache&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;proxy_cache_key&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$uri&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;proxy_cache_valid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;302&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;24h&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;proxy_cache_valid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;301&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;30d&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;proxy_cache_valid&lt;span class="w"&gt; &lt;/span&gt;any&lt;span class="w"&gt; &lt;/span&gt;5m&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;add_header&lt;span class="w"&gt; &lt;/span&gt;X-CACHE&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Give me five&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;!-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$request_filename&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;proxy_pass&lt;span class="w"&gt; &lt;/span&gt;http://www&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;location&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;proxy_pass&lt;span class="w"&gt; &lt;/span&gt;http://www&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h1&gt;4. é˜²ç«å¢™é…ç½®çš„&amp;nbsp;Playbook&lt;/h1&gt;
&lt;p&gt;æ­¤ Playbook ä½¿ç”¨ &lt;span class="caps"&gt;UFW&lt;/span&gt;&amp;nbsp;é…ç½®åŸºæœ¬é˜²ç«å¢™ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;---&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;é…ç½®UFWé˜²ç«å¢™&lt;/span&gt;
  &lt;span class="n"&gt;hosts&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;{{ host }}&amp;quot;&lt;/span&gt;
  &lt;span class="n"&gt;become&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;
  &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;å…è®¸SSHè¿æ¥&lt;/span&gt;
      &lt;span class="n"&gt;ufw&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;rule&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;allow&lt;/span&gt;
        &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;22&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;å…è®¸HTTPå’ŒHTTPSæµé‡&lt;/span&gt;
      &lt;span class="n"&gt;ufw&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;rule&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;allow&lt;/span&gt;
        &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;{{ item }}&amp;quot;&lt;/span&gt;
      &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;80&lt;/span&gt;
        &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;443&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;å¯ç”¨UFW&lt;/span&gt;
      &lt;span class="n"&gt;ufw&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;enabled&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;ufw æ¨¡å—: é…ç½® Uncomplicated Firewall (&lt;span class="caps"&gt;UFW&lt;/span&gt;)ï¼Œå…è®¸ &lt;span class="caps"&gt;SSH&lt;/span&gt; (22) å’Œ Web æµé‡ (80, 443)&amp;nbsp;ç­‰å¿…è¦ç«¯å£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;5. åº”ç”¨éƒ¨ç½²çš„&amp;nbsp;Playbook&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨æ­¤å¯é‡ç”¨ Playbook&amp;nbsp;è‡ªåŠ¨åŒ–åº”ç”¨éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;---&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;éƒ¨ç½²Python&lt;/span&gt; &lt;span class="n"&gt;Webåº”ç”¨&lt;/span&gt;
  &lt;span class="n"&gt;hosts&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;{{ host }}&amp;quot;&lt;/span&gt;
  &lt;span class="n"&gt;become&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;
  &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;å®‰è£…Pythonä¾èµ–&lt;/span&gt;
      &lt;span class="n"&gt;apt&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
          &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;python3&lt;/span&gt;
          &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;python3&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;pip&lt;/span&gt;
        &lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;present&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;å®‰è£…æ‰€éœ€çš„PythonåŒ…&lt;/span&gt;
      &lt;span class="n"&gt;pip&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
          &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;flask&lt;/span&gt;
          &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;gunicorn&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;åˆ›å»ºç›®å½•&lt;/span&gt;
      &lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;myapp&lt;/span&gt;
        &lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;directory&lt;/span&gt;
        &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;0755&amp;#39;&lt;/span&gt;  &lt;span class="c1"&gt;# è®¾ç½®ç›®å½•æƒé™ï¼Œå¯é€‰&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;å¤åˆ¶åº”ç”¨ä»£ç &lt;/span&gt;
      &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;
        &lt;span class="n"&gt;dest&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;myapp&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;å¯åŠ¨åº”ç”¨&lt;/span&gt;
      &lt;span class="n"&gt;shell&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
        &lt;span class="n"&gt;nohup&lt;/span&gt; &lt;span class="n"&gt;gunicorn&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="mf"&gt;0.0.0.0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;8000&lt;/span&gt; &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
      &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;chdir&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;myapp&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;pip æ¨¡å—: å®‰è£… Flask å’Œ Gunicorn ç­‰ Python&amp;nbsp;åŒ…ã€‚&lt;/li&gt;
&lt;li&gt;shell æ¨¡å—: ä½¿ç”¨ Gunicorn&amp;nbsp;ä½œä¸ºåå°è¿›ç¨‹å¯åŠ¨åº”ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;app.py&amp;nbsp;æ˜¯ä¸ªæœ€ç®€å•çš„flaskåº”ç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;
&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nd"&gt;@app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;hello_flask&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hello, Flask!&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h1&gt;6. æ•°æ®åº“è®¾ç½®çš„&amp;nbsp;Playbook&lt;/h1&gt;
&lt;p&gt;å¿«é€Ÿè®¾ç½®å¹¶ä¿æŠ¤ MySQL&amp;nbsp;æ•°æ®åº“ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;---&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;è®¾ç½®MySQL&lt;/span&gt;
  &lt;span class="n"&gt;hosts&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;db_servers&lt;/span&gt;
  &lt;span class="n"&gt;become&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;
  &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;å®‰è£…MySQLæœåŠ¡å™¨&lt;/span&gt;
      &lt;span class="n"&gt;package&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt;
        &lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;present&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;è®¾ç½®MySQLrootå¯†ç &lt;/span&gt;
      &lt;span class="n"&gt;mysql_user&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;login_user&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;root&lt;/span&gt;
        &lt;span class="n"&gt;login_password&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;root&lt;/span&gt;
        &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;secure_password&lt;/span&gt;
        &lt;span class="n"&gt;host_all&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;true&lt;/span&gt;
        &lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;present&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;mysql_user æ¨¡å—: åˆ›å»ºå¹¶ä¿æŠ¤ MySQL çš„ root&amp;nbsp;ç”¨æˆ·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;7. ç³»ç»Ÿç›‘æ§çš„&amp;nbsp;Playbook&lt;/h1&gt;
&lt;p&gt;è‡ªåŠ¨åŒ–å®‰è£… Prometheus å’Œ Node Exporter&amp;nbsp;ç­‰ç›‘æ§å·¥å…·ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;---&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;è®¾ç½®ç³»ç»Ÿç›‘æ§&lt;/span&gt;
  &lt;span class="n"&gt;hosts&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;{{ host }}&amp;quot;&lt;/span&gt;
  &lt;span class="n"&gt;become&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;
  &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;å®‰è£…NodeExporter&lt;/span&gt;
      &lt;span class="n"&gt;get_url&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;prometheus&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;node_exporter&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;releases&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;download&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;v1&lt;/span&gt;&lt;span class="mf"&gt;.6.0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;node_exporter&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.6.0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;amd64&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gz&lt;/span&gt;
        &lt;span class="n"&gt;dest&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;node_exporter&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gz&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;è§£å‹NodeExporter&lt;/span&gt;
      &lt;span class="n"&gt;unarchive&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;node_exporter&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gz&lt;/span&gt;
        &lt;span class="n"&gt;dest&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nb"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;
        &lt;span class="n"&gt;extra_opts&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;--strip-components=1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;  &lt;span class="c1"&gt;# å»æ‰ä¸€å±‚ç›®å½•ç»“æ„&lt;/span&gt;
        &lt;span class="n"&gt;remote_src&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;
    &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;å¯åŠ¨NodeExporter&lt;/span&gt;
      &lt;span class="n"&gt;shell&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
        &lt;span class="n"&gt;nohup&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nb"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;node_exporter&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;get_url æ¨¡å—: ä¸‹è½½ Node Exporter&amp;nbsp;äºŒè¿›åˆ¶æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;unarchive æ¨¡å—:&amp;nbsp;å°†äºŒè¿›åˆ¶æ–‡ä»¶è§£å‹åˆ°æŒ‡å®šä½ç½®ã€‚&lt;/li&gt;
&lt;/ul&gt;</content><category term="è¿ç»´"></category><category term="blog"></category><category term="linux"></category><category term="python"></category><category term="devops"></category></entry><entry><title>ä¸€å°å†™ç»™å„¿å­çš„ä¿¡</title><link href="https://shaodongjun.github.io/posts/2025/02/12/a-letter-to-my-son/" rel="alternate"></link><published>2025-02-12T08:33:00+08:00</published><updated>2025-02-12T08:33:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-02-12:/posts/2025/02/12/a-letter-to-my-son/</id><summary type="html">&lt;p&gt;&lt;img alt="ilovemyson" src="/images/ilovemyson.jpg"&gt;&lt;/p&gt;
&lt;h2&gt;äº²çˆ±çš„å­©å­ï¼š&lt;/h2&gt;
&lt;p&gt;å½“ä½ æ‰“å¼€è¿™å°ä¿¡çš„æ—¶å€™ï¼Œæˆ–è®¸å·²ç»è¿‡å»äº†å¾ˆä¹…ï¼Œæˆ–è®¸ä½ å·²ç»é•¿å¤§æˆäººï¼Œç”šè‡³æœ‰äº†è‡ªå·±çš„å®¶åº­å’Œè´£ä»»ã€‚æ— è®ºä½ æ­¤åˆ» â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;img alt="ilovemyson" src="/images/ilovemyson.jpg"&gt;&lt;/p&gt;
&lt;h2&gt;äº²çˆ±çš„å­©å­ï¼š&lt;/h2&gt;
&lt;p&gt;å½“ä½ æ‰“å¼€è¿™å°ä¿¡çš„æ—¶å€™ï¼Œæˆ–è®¸å·²ç»è¿‡å»äº†å¾ˆä¹…ï¼Œæˆ–è®¸ä½ å·²ç»é•¿å¤§æˆäººï¼Œç”šè‡³æœ‰äº†è‡ªå·±çš„å®¶åº­å’Œè´£ä»»ã€‚æ— è®ºä½ æ­¤åˆ»èº«å¤„ä½•åœ°ï¼Œè¿‡ç€æ€æ ·çš„ç”Ÿæ´»ï¼Œæˆ‘éƒ½å¸Œæœ›ä½ èƒ½é™ä¸‹å¿ƒæ¥ï¼Œè¯»å®Œè¿™å°ä¿¡ã€‚è¿™å°ä¿¡ä¸ä»…æ˜¯æˆ‘ä½œä¸ºçˆ¶äº²å¯¹ä½ çš„æœŸæœ›ï¼Œä¹Ÿæ˜¯æˆ‘å¯¹ä½ æœªæ¥äººç”Ÿçš„ç¥ç¦ä¸æé†’ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘æƒ³å‘Šè¯‰ä½ ï¼Œ&lt;font color=#cc3300&gt;&lt;strong&gt;çˆ¸çˆ¸ä¸€ç›´éƒ½å¾ˆçˆ±ä½ &lt;/strong&gt;ã€‚&lt;/font&gt;æ— è®ºä½ æ›¾ç»åœ¨å­¦ä¹ ä¸Šè¡¨ç°å¾—å¦‚ä½•ï¼Œæ— è®ºä½ æ˜¯å¦æ›¾ç»æ²‰è¿·äºæ¸¸æˆï¼Œç”šè‡³ä¸ºäº†æ‰‹æœºè€Œç»é£Ÿï¼Œè¿™äº›éƒ½ä¸ä¼šæ”¹å˜æˆ‘å¯¹ä½ çš„çˆ±ã€‚ä½ æ˜¯æˆ‘ç”Ÿå‘½ä¸­æœ€é‡è¦çš„äººä¹‹ä¸€ï¼Œ&lt;font color=#cc3300&gt;&lt;strong&gt;æˆ‘å¸Œæœ›ä½ å¥åº·ã€å¿«ä¹ã€é˜³å…‰ï¼Œæˆä¸ºä¸€ä¸ªå†…å¿ƒå¼ºå¤§ä¸”å……æ»¡æ„Ÿæ©çš„äºº&lt;/strong&gt;ã€‚&lt;/font&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘çŸ¥é“ï¼Œå­¦ä¹ å¯¹ä½ æ¥è¯´å¯èƒ½æ˜¯ä¸€ä»¶æ¯ç‡¥çš„äº‹æƒ…ï¼Œå°¤å…¶æ˜¯é‚£äº›éœ€è¦èƒŒè¯µçš„çŸ¥è¯†ï¼Œæ¯”å¦‚å†å²ã€åœ°ç†ã€è¯­æ–‡ï¼Œç”šè‡³æ˜¯è‹±è¯­å•è¯ã€‚ä½ å¯èƒ½ä¼šè§‰å¾—è¿™äº›ä¸œè¥¿æ¯«æ— æ„ä¹‰ï¼Œç”šè‡³è§‰å¾—å®ƒä»¬ä¸ä½ çš„ç”Ÿæ´»æ— å…³ã€‚ä½†æˆ‘æƒ³å‘Šè¯‰ä½ ï¼Œ&lt;font color=#cc3300&gt;&lt;strong&gt;å­¦ä¹ ä¸ä»…ä»…æ˜¯ä¸ºäº†è€ƒè¯•å¾—åˆ†ï¼Œå®ƒæ›´æ˜¯ä¸€ç§åŸ¹å…»ä½ æ€ç»´ã€æ‹“å®½ä½ è§†é‡çš„æ–¹å¼ã€‚&lt;/strong&gt;&lt;/font&gt;é€šè¿‡å­¦ä¹ ï¼Œä½ å¯ä»¥äº†è§£è¿™ä¸ªä¸–ç•Œæ˜¯å¦‚ä½•è¿è½¬çš„ï¼Œäº†è§£äººç±»çš„å†å²ã€æ–‡åŒ–ã€åœ°ç†ç¯å¢ƒï¼Œç”šè‡³é€šè¿‡è¯­è¨€ä¸æ›´å¤šçš„äººäº¤æµã€‚&lt;font color=#cc3300&gt;&lt;strong&gt;è¿™äº›çŸ¥è¯†æˆ–è®¸ä¸ä¼šç«‹åˆ»æ”¹å˜ä½ çš„ç”Ÿæ´»ï¼Œä½†å®ƒä»¬ä¼šåœ¨æœªæ¥çš„æŸä¸€å¤©ï¼Œæˆä¸ºä½ äººç”Ÿä¸­çš„å®è´µè´¢å¯Œ&lt;/strong&gt;ã€‚&lt;/font&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä¹Ÿæ˜ç™½ï¼Œæ¸¸æˆå¯¹ä½ æ¥è¯´å……æ»¡äº†å¸å¼•åŠ›ã€‚å®ƒè®©ä½ æ„Ÿåˆ°å¿«ä¹ã€æ”¾æ¾ï¼Œç”šè‡³è®©ä½ è§‰å¾—è‡ªå·±åœ¨è™šæ‹Ÿä¸–ç•Œä¸­æ— æ‰€ä¸èƒ½ã€‚ä½†å­©å­ï¼Œæ¸¸æˆç»ˆç©¶æ˜¯è™šæ‹Ÿçš„ï¼Œå®ƒæ— æ³•ä»£æ›¿ç°å®ç”Ÿæ´»ä¸­çš„æˆé•¿ä¸è¿›æ­¥ã€‚ä½ å¯ä»¥äº«å—æ¸¸æˆçš„ä¹è¶£ï¼Œä½†ä¸è¦è®©æ¸¸æˆå æ®ä½ å…¨éƒ¨çš„æ—¶é—´å’Œç²¾åŠ›ã€‚&lt;font color=#cc3300&gt;&lt;strong&gt;çœŸæ­£çš„æˆå°±æ„Ÿï¼Œæ¥è‡ªäºä½ åœ¨ç°å®ä¸–ç•Œä¸­çš„åŠªåŠ›ä¸åšæŒï¼Œè€Œä¸æ˜¯è™šæ‹Ÿä¸–ç•Œä¸­çš„çŸ­æš‚èƒœåˆ©&lt;/strong&gt;ã€‚&lt;/font&gt;&lt;/p&gt;
&lt;p&gt;çˆ¸çˆ¸å¹¶ä¸è¦æ±‚ä½ ä¸€å®šè¦æˆä¸ºå­¦éœ¸ï¼Œä¹Ÿä¸è¦æ±‚ä½ åœ¨å­¦ä¸šä¸Šå–å¾—å¤šä¹ˆè¾‰ç…Œçš„æˆç»©ã€‚æˆ‘å¯¹ä½ çš„æœŸæœ›å¾ˆç®€å•ï¼šå¸Œæœ›ä½ èƒ½å¤Ÿæ‰¾åˆ°è‡ªå·±çœŸæ­£æ„Ÿå…´è¶£çš„äº‹æƒ…ï¼Œå¹¶ä¸ºä¹‹ä»˜å‡ºåŠªåŠ›ã€‚æ— è®ºæ˜¯éŸ³ä¹ã€ç»˜ç”»ã€è¿åŠ¨ã€ç§‘æŠ€ï¼Œè¿˜æ˜¯å…¶ä»–ä»»ä½•é¢†åŸŸï¼Œ&lt;font color=#cc3300&gt;&lt;strong&gt;åªè¦ä½ çƒ­çˆ±å®ƒï¼Œå¹¶ä¸”æ„¿æ„ä¸ºä¹‹åšæŒï¼Œçˆ¸çˆ¸éƒ½ä¼šæ”¯æŒä½ ã€‚é‡è¦çš„æ˜¯ï¼Œä½ è¦å­¦ä¼šä¸ºè‡ªå·±çš„é€‰æ‹©è´Ÿè´£ï¼Œå­¦ä¼šåœ¨å›°éš¾é¢å‰ä¸è½»æ˜“æ”¾å¼ƒ&lt;/strong&gt;ã€‚&lt;/font&gt;&lt;/p&gt;
&lt;p&gt;å­©å­ï¼Œäººç”Ÿå¾ˆé•¿ï¼Œå­¦ä¹ åªæ˜¯å…¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚&lt;font color=#cc3300&gt;&lt;strong&gt;ä½†å­¦ä¹ çš„æ€åº¦ï¼Œå¾€å¾€å†³å®šäº†ä½ æœªæ¥äººç”Ÿçš„é«˜åº¦ã€‚&lt;/strong&gt;&lt;/font&gt;å¦‚æœä½ ç°åœ¨ä¸æ„¿æ„ä¸ºå­¦ä¹ ä»˜å‡ºåŠªåŠ›ï¼Œæœªæ¥å¯èƒ½ä¼šé¢ä¸´æ›´å¤šçš„æŒ‘æˆ˜å’Œå›°éš¾ã€‚æˆ‘ä¸å¸Œæœ›ä½ å°†æ¥åæ‚”ï¼Œåæ‚”è‡ªå·±æ›¾ç»æ²¡æœ‰å¥½å¥½æŠŠæ¡æ—¶å…‰ï¼Œåæ‚”è‡ªå·±æ›¾ç»æ²¡æœ‰ä¸ºæ¢¦æƒ³ä»˜å‡ºè¶³å¤Ÿçš„åŠªåŠ›ã€‚&lt;/p&gt;
&lt;p&gt;&lt;font color=#cc3300&gt;&lt;strong&gt;æœªæ¥çš„è·¯è¿˜å¾ˆé•¿ï¼Œçˆ¸çˆ¸å¸Œæœ›ä½ èƒ½å¤Ÿçæƒœæ¯ä¸€å¤©ï¼Œçæƒœæ¯ä¸€æ¬¡æˆé•¿çš„æœºä¼šã€‚&lt;/strong&gt;&lt;/font&gt;è‹¥å¹²å¹´åï¼Œå½“ä½ å›æƒ³èµ·è¿™æ®µæ—¶å…‰æ—¶ï¼Œå¸Œæœ›ä½ èƒ½å¤Ÿå¿ƒå­˜æ„Ÿæ©ï¼Œæ„Ÿæ©æ›¾ç»çš„è‡ªå·±ï¼Œæ„Ÿæ©é‚£äº›é™ªä¼´ä½ æˆé•¿çš„äººå’Œäº‹ã€‚ç„¶åï¼Œ&lt;font color=#cc3300&gt;&lt;strong&gt;ç»§ç»­å‹‡æ•¢å‰è¡Œï¼Œå»è¿½é€å±äºä½ çš„æ¢¦æƒ³ã€‚&lt;/strong&gt; &lt;/font&gt;&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œæˆ‘æƒ³å‘Šè¯‰ä½ ï¼Œæ— è®ºä½ å°†æ¥æˆä¸ºæ€æ ·çš„äººï¼Œæ— è®ºä½ é€‰æ‹©æ€æ ·çš„é“è·¯ï¼Œçˆ¸çˆ¸éƒ½ä¼šä¸ºä½ æ„Ÿåˆ°éª„å‚²ã€‚&lt;font color=#cc3300&gt;&lt;strong&gt;åªè¦ä½ èº«ä½“å¥åº·ï¼Œå¿ƒç†é˜³å…‰ï¼Œå¿ƒæ€€æ„Ÿæ©ï¼Œå‹‡æ•¢å‰è¡Œï¼Œä½ å°±æ˜¯æˆ‘æœ€æ£’çš„å­©å­&lt;/strong&gt;ã€‚&lt;/font&gt;&lt;/p&gt;
&lt;h2&gt;çˆ±ä½ çš„çˆ¸çˆ¸å’Œå¦ˆå¦ˆ&lt;/h2&gt;</content><category term="æ‚è®°"></category><category term="blog"></category><category term="misc"></category><category term="study"></category></entry><entry><title>ä½¿ç”¨ configparserÂ è½»æ¾ç®¡ç†é…ç½®æ–‡ä»¶</title><link href="https://shaodongjun.github.io/posts/2025/02/08/python-configparser/" rel="alternate"></link><published>2025-02-08T15:30:00+08:00</published><updated>2025-02-08T15:30:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-02-08:/posts/2025/02/08/python-configparser/</id><summary type="html">&lt;h2&gt;configparser&amp;nbsp;æ˜¯ä»€ä¹ˆ?&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;configparser&lt;/strong&gt; æ˜¯ Python æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œå®ƒæä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥å¤„ç†ç±»ä¼¼ Windows &lt;span class="caps"&gt;INI&lt;/span&gt; æ–‡ä»¶æ ¼å¼çš„é…ç½®æ–‡ä»¶ã€‚
configparser&amp;nbsp;æ¨¡å—å…è®¸æˆ‘ä»¬ â€¦&lt;/p&gt;</summary><content type="html">&lt;h2&gt;configparser&amp;nbsp;æ˜¯ä»€ä¹ˆ?&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;configparser&lt;/strong&gt; æ˜¯ Python æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œå®ƒæä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥å¤„ç†ç±»ä¼¼ Windows &lt;span class="caps"&gt;INI&lt;/span&gt; æ–‡ä»¶æ ¼å¼çš„é…ç½®æ–‡ä»¶ã€‚
configparser&amp;nbsp;æ¨¡å—å…è®¸æˆ‘ä»¬å¯ä»¥è½»æ¾åœ°è¯»å–ã€å†™å…¥å’Œæ“ä½œè¿™äº›é…ç½®æ–‡ä»¶ï¼Œå°†ç¨‹åºçš„è®¾ç½®ä¸ä»£ç åˆ†ç¦»ï¼Œæ–¹ä¾¿åœ¨ä¸ä¿®æ”¹ä»£ç çš„æƒ…å†µä¸‹è°ƒæ•´ç¨‹åºçš„è¡Œä¸ºã€‚&lt;/p&gt;
&lt;h2&gt;configparser&amp;nbsp;ä¼˜åŠ¿ä¸åº”ç”¨åœºæ™¯&lt;/h2&gt;
&lt;h3&gt;ä¼˜åŠ¿&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç®€å•æ˜“ç”¨ï¼šconfigparser æ¨¡å—çš„ &lt;span class="caps"&gt;API&lt;/span&gt;&amp;nbsp;ç®€æ´æ˜äº†ï¼Œæ˜“äºä¸Šæ‰‹ï¼Œå³ä½¿æ˜¯åˆå­¦è€…ä¹Ÿèƒ½å¿«é€ŸæŒæ¡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è·¨å¹³å°æ€§ï¼šç”±äºå…¶åŸºäºç±»ä¼¼ Windows &lt;span class="caps"&gt;INI&lt;/span&gt;&amp;nbsp;æ–‡ä»¶çš„æ ¼å¼ï¼Œåœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¸Šéƒ½èƒ½å¾ˆå¥½åœ°å·¥ä½œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;çµæ´»æ€§ï¼šæ”¯æŒè¯»å–ã€å†™å…¥å’Œä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œèƒ½å¤Ÿæ»¡è¶³å„ç§é…ç½®ç®¡ç†éœ€æ±‚ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;åº”ç”¨åœºæ™¯&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;é¡¹ç›®é…ç½®ç®¡ç†ï¼šåœ¨è½¯ä»¶å¼€å‘é¡¹ç›®ä¸­ï¼Œç”¨äºå­˜å‚¨æ•°æ®åº“è¿æ¥ä¿¡æ¯ã€æ—¥å¿—é…ç½®ã€æœåŠ¡å™¨å‚æ•°ç­‰&lt;strong&gt;æ•æ„Ÿ&lt;/strong&gt;æ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”¨æˆ·åå¥½è®¾ç½®ï¼šåœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œä¿å­˜ç”¨æˆ·çš„ä¸ªæ€§åŒ–è®¾ç½®ï¼Œå¦‚ç•Œé¢ä¸»é¢˜ã€è¯­è¨€ç­‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æµ‹è¯•ç¯å¢ƒé…ç½®ï¼šåœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæ–¹ä¾¿åœ°åˆ‡æ¢ä¸åŒçš„æµ‹è¯•ç¯å¢ƒé…ç½®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;configparser&amp;nbsp;åŸºæœ¬ä½¿ç”¨&lt;/h2&gt;
&lt;h3&gt;å®‰è£…ä¸å¯¼å…¥&lt;/h3&gt;
&lt;p&gt;configparser æ¨¡å—æ˜¯ Python&amp;nbsp;çš„å†…ç½®æ¨¡å—ï¼Œæ— éœ€é¢å¤–å®‰è£…ã€‚ä½¿ç”¨æ—¶ï¼Œåªéœ€å¯¼å…¥å³å¯ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;configparser&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;è¯»å–é…ç½®æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º&lt;code&gt;config.ini&lt;/code&gt;çš„é…ç½®æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;database&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nv"&gt;host&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;localhost
&lt;span class="nv"&gt;user&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root
&lt;span class="nv"&gt;password&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;123456&lt;/span&gt;

&lt;span class="o"&gt;[&lt;/span&gt;logging&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nv"&gt;level&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;DEBUG
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç è¯»å–è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;configparser&lt;/span&gt;

&lt;span class="n"&gt;config&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;configparser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConfigParser&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;config.ini&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# è¯»å–æ•°æ®åº“é…ç½®&lt;/span&gt;
&lt;span class="n"&gt;db_host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;database&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;host&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;db_user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;database&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;db_port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;database&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;port&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fallback&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3306&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;db_password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;database&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;password&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# è¯»å–æ—¥å¿—é…ç½®&lt;/span&gt;
&lt;span class="c1"&gt;# å¯ä»¥ä¸ºé…ç½®é¡¹æŒ‡å®šé»˜è®¤å€¼ï¼Œä»¥é˜²æ­¢é…ç½®æ–‡ä»¶ä¸­ç¼ºå°‘æŸäº›é¡¹æ—¶ç¨‹åºå‡ºé”™ã€‚&lt;/span&gt;
&lt;span class="n"&gt;log_level&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;logging&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;level&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fallback&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;INFO&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Database Host: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;db_host&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;, Port: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;db_port&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;, User: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;db_user&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;, Password: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;db_password&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªConfigParserå¯¹è±¡ï¼Œç„¶åä½¿ç”¨readæ–¹æ³•è¯»å–é…ç½®æ–‡ä»¶ã€‚æ¥ç€ï¼Œé€šè¿‡getæ–¹æ³•è·å–å­—ç¬¦ä¸²ç±»å‹çš„é…ç½®é¡¹ï¼Œä½¿ç”¨&lt;code&gt;getint&lt;/code&gt;æ–¹æ³•è·å–æ•´æ•°ç±»å‹çš„é…ç½®é¡¹ï¼ˆå¯¹äºå…¶ä»–ç±»å‹ï¼Œè¿˜æœ‰&lt;code&gt;getfloat&lt;/code&gt;ã€&lt;code&gt;getboolean&lt;/code&gt;ç­‰æ–¹æ³•ï¼‰ã€‚&lt;/p&gt;
&lt;h3&gt;å†™å…¥é…ç½®æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ configparser&amp;nbsp;æ¨¡å—æ¥åˆ›å»ºæˆ–ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;configparser&lt;/span&gt;

&lt;span class="n"&gt;config&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;configparser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConfigParser&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# æ·»åŠ ä¸€ä¸ªæ–°çš„section&lt;/span&gt;
&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;webserver&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;host&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;127.0.0.1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;port&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;8080&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;False&amp;#39;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;# å°†é…ç½®å†™å…¥æ–‡ä»¶&lt;/span&gt;
&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;config.ini&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;a+&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;configfile&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;configfile&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;configparser&amp;nbsp;æ³¨æ„äº‹é¡¹&lt;/h2&gt;
&lt;h3&gt;è¯­æ³•è¦æ±‚ä¸¥æ ¼&lt;/h3&gt;
&lt;p&gt;configparser æ¨¡å—å¯¹é…ç½®æ–‡ä»¶çš„è¯­æ³•æœ‰ä¸€å®šè¦æ±‚ï¼Œä¾‹å¦‚ section&amp;nbsp;åç§°å’Œé…ç½®é¡¹åç§°ä¸èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼Œç­‰å·ä¸¤ä¾§çš„ç©ºæ ¼ç­‰ä¹Ÿéœ€è¦æ³¨æ„ã€‚å¦åˆ™ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¯»å–æˆ–å†™å…¥å¤±è´¥ã€‚&lt;/p&gt;
&lt;h3&gt;ç±»å‹è½¬æ¢é—®é¢˜&lt;/h3&gt;
&lt;p&gt;åœ¨ä½¿ç”¨getintã€getfloatç­‰æ–¹æ³•è¿›è¡Œç±»å‹è½¬æ¢æ—¶ï¼Œå¦‚æœé…ç½®æ–‡ä»¶ä¸­çš„å€¼ä¸ç¬¦åˆç›¸åº”ç±»å‹çš„è¦æ±‚ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨æ—¶éœ€è¦è¿›è¡Œé€‚å½“çš„é”™è¯¯å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;configparser æ¨¡å—ä½œä¸º Python ä¸­å¤„ç†é…ç½®æ–‡ä»¶çš„é‡è¦å·¥å…·ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§é«˜æ•ˆã€ä¾¿æ·çš„æ–¹å¼æ¥ç®¡ç†é¡¹ç›®çš„é…ç½®ä¿¡æ¯ã€‚é€šè¿‡åˆç†è¿ç”¨å®ƒçš„å„ç§åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç¨‹åºæ›´åŠ çµæ´»ã€å¯ç»´æŠ¤ï¼Œæ›´å¥½åœ°é€‚åº”ä¸åŒçš„ç¯å¢ƒå’Œéœ€æ±‚ã€‚æ— è®ºæ˜¯å°å‹è„šæœ¬è¿˜æ˜¯å¤§å‹é¡¹ç›®ï¼Œconfigparser&amp;nbsp;æ¨¡å—éƒ½å€¼å¾—æˆ‘ä»¬æ·±å…¥å­¦ä¹ å’ŒæŒæ¡ã€‚&lt;/p&gt;</content><category term="ç¼–ç¨‹"></category><category term="blog"></category><category term="python"></category><category term="config"></category></entry><entry><title>ä½¿ç”¨ PIL(pillow)Â å®ç°å›¾ç‰‡æ°´å°*ä¼˜åŒ–ç‰ˆ</title><link href="https://shaodongjun.github.io/posts/2025/02/07/python-pillow-watermark/" rel="alternate"></link><published>2025-02-07T15:55:00+08:00</published><updated>2025-02-07T15:55:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-02-07:/posts/2025/02/07/python-pillow-watermark/</id><summary type="html">&lt;p&gt;&lt;strong&gt;Pillow&lt;/strong&gt; æ˜¯ä¸€ä¸ªç”¨äºå›¾åƒå¤„ç†çš„ Python åº“ï¼Œæ˜¯ Python Imaging Library (&lt;span class="caps"&gt;PIL&lt;/span&gt;)&amp;nbsp;çš„ä¸€ä¸ªåˆ†æ”¯å’Œæ›´æ–°ç‰ˆæœ¬ã€‚å®ƒæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ï¼Œç”¨äºæ‰“å¼€ã€æ“ä½œå’Œä¿å­˜å¤šç§æ ¼å¼ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;strong&gt;Pillow&lt;/strong&gt; æ˜¯ä¸€ä¸ªç”¨äºå›¾åƒå¤„ç†çš„ Python åº“ï¼Œæ˜¯ Python Imaging Library (&lt;span class="caps"&gt;PIL&lt;/span&gt;)&amp;nbsp;çš„ä¸€ä¸ªåˆ†æ”¯å’Œæ›´æ–°ç‰ˆæœ¬ã€‚å®ƒæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ï¼Œç”¨äºæ‰“å¼€ã€æ“ä½œå’Œä¿å­˜å¤šç§æ ¼å¼çš„å›¾åƒã€‚&lt;/p&gt;
&lt;h2&gt;ä¼˜ç‚¹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ˜“äºä½¿ç”¨ï¼šPillow æä¾›äº†ç®€å•æ˜“æ‡‚çš„ &lt;span class="caps"&gt;API&lt;/span&gt;ï¼Œé€‚åˆåˆå­¦è€…å’Œä¸“ä¸šå¼€å‘è€…ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒå¤šç§æ ¼å¼ï¼šå¯ä»¥å¤„ç†å¤šç§å›¾åƒæ ¼å¼ï¼Œå¦‚ &lt;span class="caps"&gt;JPEG&lt;/span&gt;ã€&lt;span class="caps"&gt;PNG&lt;/span&gt;ã€&lt;span class="caps"&gt;GIF&lt;/span&gt;ã€&lt;span class="caps"&gt;BMP&lt;/span&gt;&amp;nbsp;ç­‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å›¾åƒå¤„ç†åŠŸèƒ½å¼ºå¤§ï¼šæä¾›äº†å¤šç§å›¾åƒå¤„ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å›¾åƒå¢å¼ºã€è¿‡æ»¤ã€å˜æ¢ã€è£å‰ªã€æ—‹è½¬ç­‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å›¾åƒåˆ›å»ºï¼šå¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºæ–°å›¾åƒï¼Œç»˜åˆ¶æ–‡æœ¬å’Œå›¾å½¢ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¿«é€Ÿé«˜æ•ˆï¼šç»è¿‡ä¼˜åŒ–ï¼Œèƒ½å¤Ÿå¤„ç†è¾ƒå¤§çš„å›¾åƒæ–‡ä»¶è€Œä¸ä¼šæ˜¾è‘—å½±å“æ€§èƒ½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ–‡æ¡£å®Œå–„ï¼šPillow&amp;nbsp;çš„æ–‡æ¡£è¯¦ç»†ï¼Œæä¾›äº†ä¸°å¯Œçš„ç¤ºä¾‹ï¼Œä¾¿äºå­¦ä¹ å’Œä½¿ç”¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¤¾åŒºæ”¯æŒï¼šä½œä¸ºä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åº“ï¼ŒPillow&amp;nbsp;æ‹¥æœ‰æ´»è·ƒçš„ç¤¾åŒºï¼Œå¯ä»¥è·å¾—å„ç§èµ„æºå’Œæ”¯æŒã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å¢åŠ æ–‡å­—æ°´å°çš„ä»£ç &lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PIL&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ImageDraw&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ImageFont&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pathlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;platform&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;system&lt;/span&gt;

&lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.8&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;IsValidImage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img_path&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºæœ‰æ•ˆï¼ˆå®Œæ•´ï¼‰çš„å›¾ç‰‡&lt;/span&gt;
&lt;span class="sd"&gt;    :param img_path:å›¾ç‰‡è·¯å¾„&lt;/span&gt;
&lt;span class="sd"&gt;    :return:Trueï¼šæœ‰æ•ˆ Falseï¼šæ— æ•ˆ&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;Valid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img_path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;verify&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;Valid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Valid&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add_mark_png&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
    &lt;span class="c1"&gt;# è®¾ç½®æ‰€ä½¿ç”¨çš„å­—ä½“&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Darwin&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;system&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="n"&gt;font_file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/System/Library/Fonts/PingFang.ttc&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Windows&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;system&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="n"&gt;font_file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;C:\windows\Fonts\msyh.ttc&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;font&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ImageFont&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;truetype&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;font_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="c1"&gt;# Opening Image &amp;amp; Creating New Text Layer&lt;/span&gt;
    &lt;span class="n"&gt;img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;suffix&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;.png&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;txt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;RGBA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="c1"&gt;# é’ˆå¯¹jpegæ— é€æ˜é€šé“,å…ˆåˆ›å»ºæ°´å°å›¾ç‰‡çš„æ¨¡å¼&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;txt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;L&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# Creating Draw Object&lt;/span&gt;
    &lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ImageDraw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Draw&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;txt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# Positioning Text&lt;/span&gt;
    &lt;span class="n"&gt;width&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;height&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;
    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="c1"&gt;# textwidth, textheight = d.textsize(words, font)&lt;/span&gt;
    &lt;span class="c1"&gt;# x=width/2-textwidth/2&lt;/span&gt;
    &lt;span class="c1"&gt;# y=height-textheight-300&lt;/span&gt;

    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;height&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;width&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;mark&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;txt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rotate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;16.8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;suffix&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;.png&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fill&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;155&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;font&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;font&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fill&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;font&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;font&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;
        &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;120&lt;/span&gt;

    &lt;span class="c1"&gt;# å¦å­˜å›¾ç‰‡&lt;/span&gt;
    &lt;span class="n"&gt;dir_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;joinpath&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æ°´å°å›¾&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;dir_name&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_dir&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mkdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dir_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;file_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stem&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;_new&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;suffix&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;_&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;file_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dir_name&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;joinpath&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;suffix&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;.png&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;watermarked&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;alpha_composite&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mark&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;watermarked&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;rgb_im&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;convert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;RGB&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;rgb_im&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;paste&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;mark&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;rgb_im&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="c1"&gt;# é’ˆå¯¹jpegæ ¼å¼çš„å›¾ç‰‡,ç”¨pasteæ–¹æ³•&lt;/span&gt;
        &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;paste&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;mark&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;å›¾ç‰‡è½¬pdfçš„ä»£ç &lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ‰“å¼€å›¾åƒï¼šä½¿ç”¨ Image.open()&amp;nbsp;æ‰“å¼€æŒ‡å®šè·¯å¾„çš„å›¾åƒæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¨¡å¼æ£€æŸ¥ä¸è½¬æ¢ï¼šå¦‚æœå›¾åƒä¸æ˜¯ &lt;span class="caps"&gt;RGB&lt;/span&gt; æ¨¡å¼ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸º &lt;span class="caps"&gt;RGB&lt;/span&gt; æ¨¡å¼ã€‚&lt;span class="caps"&gt;PDF&lt;/span&gt; æ ¼å¼é€šå¸¸è¦æ±‚å›¾åƒä¸º &lt;span class="caps"&gt;RGB&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¿å­˜ä¸º &lt;span class="caps"&gt;PDF&lt;/span&gt;ï¼šä½¿ç”¨ image.save() æ–¹æ³•å°†å›¾åƒä¿å­˜ä¸º &lt;span class="caps"&gt;PDF&lt;/span&gt;&amp;nbsp;æ–‡ä»¶ï¼ŒåŒæ—¶å¯ä»¥æŒ‡å®šåˆ†è¾¨ç‡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒå¤šå›¾åƒï¼šå¦‚æœéœ€è¦æ”¯æŒå°†å¤šä¸ªå›¾åƒåˆå¹¶ä¸ºä¸€ä¸ª &lt;span class="caps"&gt;PDF&lt;/span&gt;ï¼Œå¯ä»¥ä½¿ç”¨ save() æ–¹æ³•çš„ append_images&amp;nbsp;å‚æ•°ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PIL&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;image_to_pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;image_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pdf_path&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# æ‰“å¼€å›¾åƒæ–‡ä»¶&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;image_path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Error opening image: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt;

    &lt;span class="c1"&gt;# æ£€æŸ¥å›¾åƒæ¨¡å¼ï¼Œå¦‚æœä¸æ˜¯ RGBï¼Œåˆ™è½¬æ¢ä¸º RGB&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mode&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;RGB&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;convert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;RGB&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# ä¿å­˜å›¾åƒä¸º PDF æ–‡ä»¶&lt;/span&gt;
    &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pdf_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PDF&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;resolution&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;100.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="ç¼–ç¨‹"></category><category term="blog"></category><category term="python"></category><category term="pillow"></category><category term="pil"></category></entry><entry><title>ä½¿ç”¨ FreeSimpleGUIÂ å®šåˆ¶å›¾å½¢ç•Œé¢</title><link href="https://shaodongjun.github.io/posts/2025/02/06/python-freesimplegui/" rel="alternate"></link><published>2025-02-06T17:18:00+08:00</published><updated>2025-02-06T17:18:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-02-06:/posts/2025/02/06/python-freesimplegui/</id><summary type="html">&lt;h2&gt;ä»€ä¹ˆæ˜¯FreeSimpleGUIï¼Ÿ&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;FreeSimpleGUI&lt;/strong&gt;æ˜¯ä¸€ä¸ªå¼€æºçš„å›¾å½¢ç”¨æˆ·ç•Œé¢åº“ï¼Œæ—¨åœ¨æä¾›ä¸€ä¸ªç®€å•ã€æ˜“ç”¨çš„GUIè§£å†³æ–¹æ¡ˆã€‚ å®ƒç®€åŒ–äº†çª—å£å’Œå…ƒç´ çš„åˆ›å»ºè¿‡ç¨‹ï¼Œé€šè¿‡ä¸€ä¸ªç®€æ´ â€¦&lt;/p&gt;</summary><content type="html">&lt;h2&gt;ä»€ä¹ˆæ˜¯FreeSimpleGUIï¼Ÿ&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;FreeSimpleGUI&lt;/strong&gt;æ˜¯ä¸€ä¸ªå¼€æºçš„å›¾å½¢ç”¨æˆ·ç•Œé¢åº“ï¼Œæ—¨åœ¨æä¾›ä¸€ä¸ªç®€å•ã€æ˜“ç”¨çš„GUIè§£å†³æ–¹æ¡ˆã€‚ å®ƒç®€åŒ–äº†çª—å£å’Œå…ƒç´ çš„åˆ›å»ºè¿‡ç¨‹ï¼Œé€šè¿‡ä¸€ä¸ªç®€æ´çš„å¸ƒå±€å®šä¹‰ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§æµè¡Œçš„ &lt;span class="caps"&gt;GUI&lt;/span&gt; æ¡†æ¶ï¼ŒåŒ…æ‹¬ tkinterã€Qtã€WxPython å’Œ Remiã€‚å®ƒé€šè¿‡å°è£…è¿™äº›æ¡†æ¶çš„å¸¸ç”¨åŠŸèƒ½ï¼Œæä¾›äº†æ›´ç®€æ´çš„ &lt;span class="caps"&gt;API&lt;/span&gt;ï¼Œè®©ä½ ä¸“æ³¨äºåº”ç”¨é€»è¾‘è€Œéç¹æ‚çš„UIç»†èŠ‚ã€‚&lt;/p&gt;
&lt;h2&gt;FreeSimpleGUIçš„ç‰¹ç‚¹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç®€å•æ˜“ç”¨ï¼šFreeSimpleGUIçš„APIè®¾è®¡éå¸¸ç®€å•æ˜“ç”¨ï¼Œä»»ä½•äººéƒ½å¯ä»¥è½»æ¾åœ°ä½¿ç”¨å®ƒæ¥åˆ›å»ºGUIåº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…è´¹ï¼šFreeSimpleGUIæ˜¯å®Œå…¨å…è´¹çš„ï¼Œä¸éœ€è¦ä»»ä½•ä»˜è´¹è®¸å¯è¯ï¼Œå¯ä»¥è‡ªç”±åœ°ä½¿ç”¨å’Œåˆ†å‘ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è·¨å¹³å°ï¼šFreeSimpleGUIæ”¯æŒå¤šç§å¹³å°ï¼ŒåŒ…æ‹¬Windowsã€MacOSå’ŒLinuxç­‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é«˜æ€§èƒ½ï¼šFreeSimpleGUIå…·æœ‰é«˜æ€§èƒ½ï¼Œèƒ½å¤Ÿå¿«é€Ÿåœ°æ¸²æŸ“å’Œå“åº”ç”¨æˆ·äº¤äº’ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;çµæ´»ï¼šFreeSimpleGUIæä¾›äº†å¤šç§è‡ªå®šä¹‰é€‰é¡¹ï¼Œå…è®¸å¼€å‘è€…æ ¹æ®éœ€è¦è¿›è¡Œè‡ªå®šä¹‰å’Œè°ƒæ•´ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;æŠ€æœ¯åº”ç”¨ç¤ºä¾‹&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;FreeSimpleGUI&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;sg&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;glob&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;glob&lt;/span&gt;

&lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.8&lt;/span&gt;

&lt;span class="c1"&gt;# ç•Œé¢å¸ƒå±€&lt;/span&gt;
&lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;theme&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TanBlue&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# å›¾å½¢ç•Œé¢å¸ƒå±€&lt;/span&gt;

&lt;span class="n"&gt;layout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Text&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;é‡è¦èµ„æ–™ç›®å½•å¤¹: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; 
     &lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;In&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;enable_events&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;_FOLDER_&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
     &lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FolderBrowse&lt;/span&gt;&lt;span class="p"&gt;()],&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Text&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æ°´å°å¤§å°: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
     &lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Slider&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;resolution&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default_value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;border_width&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;text_color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;navy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;orientation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;horizontal&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;_SCALE_&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)],&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Text&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;æ°´å°æ–‡å­—:&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; 
     &lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;InputText&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;_WORDS_&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)],&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Button&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OK&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;  &lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Button&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Exit&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)],&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="n"&gt;types&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;png&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;jpg&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;jpeg&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="n"&gt;window&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Window&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;åˆæ‹äº‘æ°´å°ç³»ç»Ÿ v&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;version&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt; -æ‚Ÿç©º&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;layout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Finalize&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;jpg_and_pngs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="n"&gt;event&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;window&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;event&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Exit&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;break&lt;/span&gt;
    &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;event&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;OK&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;_FOLDER_&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;_WORDS_&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;popup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æ°´å°æ–‡å­—ä¸èƒ½ä¸ºç©º!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="k"&gt;continue&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;types&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;_FOLDER_&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;/*.&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
                &lt;span class="n"&gt;this_type_files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;glob&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="n"&gt;jpg_and_pngs&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;this_type_files&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jpg_and_pngs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;popup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æ²¡æœ‰å‘ç°å›¾ç‰‡!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="k"&gt;continue&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;jpg_and_pngs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;IsValidImage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                        &lt;span class="n"&gt;add_mark_png&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;_WORDS_&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;_SCALE_&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
                    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                        &lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;popup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;å›¾ç‰‡æ ¼å¼ä¸åç¼€åä¸ç¬¦!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                        &lt;span class="k"&gt;continue&lt;/span&gt;
            &lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;popup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;å¤„ç†å®Œæ¯•!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;sg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;popup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ç›®å½•ä¸èƒ½ä¸ºç©º!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;window&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="ç¼–ç¨‹"></category><category term="blog"></category><category term="python"></category><category term="gui"></category><category term="tkinter"></category></entry><entry><title>ä½¿ç”¨ python-pptxÂ åº“åˆ¶ä½œPowerPoint</title><link href="https://shaodongjun.github.io/posts/2025/02/05/python-pptx-powerpoint/" rel="alternate"></link><published>2025-02-05T17:38:00+08:00</published><updated>2025-02-05T17:38:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-02-05:/posts/2025/02/05/python-pptx-powerpoint/</id><summary type="html">&lt;h2&gt;python-pptx&amp;nbsp;åº“ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://python-pptx.readthedocs.io/"&gt;python-pptx&lt;/a&gt; æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»ºå’Œä¿®æ”¹ PowerPoint (.pptx) æ–‡ä»¶çš„ Python&amp;nbsp;åº“ã€‚å®ƒæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿæ–¹ä¾¿åœ°ç”Ÿæˆæ¼”ç¤ºæ–‡ç¨¿ï¼Œå¹¶ä¸”å¯ä»¥è¿› â€¦&lt;/p&gt;</summary><content type="html">&lt;h2&gt;python-pptx&amp;nbsp;åº“ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://python-pptx.readthedocs.io/"&gt;python-pptx&lt;/a&gt; æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»ºå’Œä¿®æ”¹ PowerPoint (.pptx) æ–‡ä»¶çš„ Python&amp;nbsp;åº“ã€‚å®ƒæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿæ–¹ä¾¿åœ°ç”Ÿæˆæ¼”ç¤ºæ–‡ç¨¿ï¼Œå¹¶ä¸”å¯ä»¥è¿›è¡Œå„ç§æ ¼å¼çš„è‡ªå®šä¹‰ã€‚&lt;/p&gt;
&lt;h2&gt;ç‰¹æ€§&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;åˆ›å»ºæ–°æ¼”ç¤ºæ–‡ç¨¿ï¼šå¯ä»¥ä»é›¶å¼€å§‹åˆ›å»ºæ–°çš„ PowerPoint&amp;nbsp;æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¿®æ”¹ç°æœ‰æ–‡ä»¶ï¼šæ”¯æŒæ‰“å¼€å’Œç¼–è¾‘å·²æœ‰çš„ .pptx&amp;nbsp;æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ·»åŠ å¹»ç¯ç‰‡ï¼šå¯ä»¥è½»æ¾åœ°æ·»åŠ ã€åˆ é™¤å’Œé‡æ–°æ’åˆ—å¹»ç¯ç‰‡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ–‡æœ¬å’Œå›¾å½¢ï¼šæ”¯æŒæ’å…¥å„ç§æ–‡æœ¬æ¡†ã€å›¾å½¢ã€å›¾ç‰‡å’Œè¡¨æ ¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è‡ªå®šä¹‰æ ¼å¼ï¼šå¯ä»¥è®¾ç½®å­—ä½“ã€é¢œè‰²ã€å¤§å°ç­‰æ ·å¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒå›¾è¡¨ï¼šå¯ä»¥æ’å…¥å’Œè‡ªå®šä¹‰å›¾è¡¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;æ³¨æ„äº‹é¡¹ï¼š&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;python-pptx &lt;u&gt;æœ¬èº«ä¸æ”¯æŒ&lt;/u&gt;&lt;/strong&gt; å¤æ‚çš„åŠ¨ç”»æ•ˆæœï¼Œå¦‚æœéœ€è¦æ›´å¤æ‚çš„åŠ¨ç”»ï¼Œå¯ä»¥åœ¨ç”Ÿæˆçš„ PowerPoint&amp;nbsp;æ–‡ä»¶ä¸­æ‰‹åŠ¨è®¾ç½®ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;åŸºæœ¬ç”¨æ³•&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ python-pptx&amp;nbsp;åˆ›å»ºä¸€ä¸ªåŒ…å«æ–‡æœ¬çš„å¹»ç¯ç‰‡ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pptx&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Presentation&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pptx.util&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pptx.enum.shapes&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MSO_SHAPE&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pptx.dml.color&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;RGBColor&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pptx.enum.dml&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MSO_THEME_COLOR&lt;/span&gt;

&lt;span class="c1"&gt;# åˆ›å»ºä¸€ä¸ªæ¼”ç¤ºæ–‡ç¨¿å¯¹è±¡&lt;/span&gt;
&lt;span class="n"&gt;prs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Presentation&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# æ·»åŠ ä¸€ä¸ªæ ‡é¢˜å¹»ç¯ç‰‡&lt;/span&gt;
&lt;span class="n"&gt;slide_layout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;slide_layouts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;  &lt;span class="c1"&gt;# 0 æ˜¯æ ‡é¢˜å¹»ç¯ç‰‡çš„å¸ƒå±€&lt;/span&gt;
&lt;span class="n"&gt;slide&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;slides&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_slide&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;slide_layout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;slide&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shapes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;
&lt;span class="n"&gt;subtitle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;slide&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;placeholders&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Python-pptx ç¤ºä¾‹&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;subtitle&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;åˆ›å»ºåŒ…å«åŸºæœ¬è¦ç´ å’Œç®€å•åŠ¨ç”»çš„PPT&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;# æ·»åŠ ä¸€ä¸ªåŒ…å«æ–‡æœ¬å’Œå›¾ç‰‡çš„å¹»ç¯ç‰‡&lt;/span&gt;
&lt;span class="n"&gt;slide_layout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;slide_layouts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;  &lt;span class="c1"&gt;# 5 æ˜¯ç©ºç™½å¹»ç¯ç‰‡çš„å¸ƒå±€&lt;/span&gt;
&lt;span class="n"&gt;slide&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;slides&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_slide&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;slide_layout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# æ·»åŠ æ ‡é¢˜&lt;/span&gt;
&lt;span class="n"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;slide&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shapes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;
&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;æ–‡æœ¬å’Œå›¾ç‰‡&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;# æ·»åŠ æ–‡æœ¬æ¡†&lt;/span&gt;
&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;top&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;width&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;height&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;textbox&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;slide&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shapes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_textbox&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;width&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;height&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;tf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;textbox&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text_frame&lt;/span&gt;
&lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ–‡æœ¬æ¡†ã€‚&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_paragraph&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;è¿™æ˜¯ç¬¬äºŒè¡Œæ–‡æœ¬ã€‚&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;# æ·»åŠ å›¾ç‰‡&lt;/span&gt;
&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;top&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;height&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pic&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;slide&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shapes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_picture&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;demo.png&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;height&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;height&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# æ·»åŠ ä¸€ä¸ªåŒ…å«è¡¨æ ¼çš„å¹»ç¯ç‰‡&lt;/span&gt;
&lt;span class="n"&gt;slide_layout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;slide_layouts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;slide&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;slides&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_slide&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;slide_layout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# æ·»åŠ æ ‡é¢˜&lt;/span&gt;
&lt;span class="n"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;slide&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shapes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;
&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;è¡¨æ ¼ç¤ºä¾‹&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;# æ·»åŠ è¡¨æ ¼&lt;/span&gt;
&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;top&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;width&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;height&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;rows&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;span class="n"&gt;cols&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="n"&gt;table&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;slide&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shapes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;width&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;height&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;

&lt;span class="c1"&gt;# å¡«å……è¡¨æ ¼æ•°æ®&lt;/span&gt;
&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;åºå·&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;åç§°&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;å€¼&amp;quot;&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;é¡¹ç›® &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# æ·»åŠ ä¸€ä¸ªåŒ…å«ç®€å•åŠ¨ç”»æ•ˆæœçš„å¹»ç¯ç‰‡&lt;/span&gt;
&lt;span class="n"&gt;slide_layout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;slide_layouts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;slide&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;slides&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_slide&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;slide_layout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# æ·»åŠ æ ‡é¢˜&lt;/span&gt;
&lt;span class="n"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;slide&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shapes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;
&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ç®€å•åŠ¨ç”»æ•ˆæœ&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;# æ·»åŠ ä¸€ä¸ªå½¢çŠ¶&lt;/span&gt;
&lt;span class="n"&gt;left&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;top&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;width&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;height&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;shape&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;slide&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shapes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_shape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MSO_SHAPE&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RECTANGLE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;top&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;width&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;height&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ç‚¹å‡»æˆ‘ï¼&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;# è®¾ç½®å½¢çŠ¶çš„å¡«å……é¢œè‰²&lt;/span&gt;
&lt;span class="n"&gt;fill&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fill&lt;/span&gt;
&lt;span class="n"&gt;fill&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solid&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;fill&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fore_color&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rgb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;RGBColor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x1E&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x90&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0xFF&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# è“è‰²&lt;/span&gt;

&lt;span class="c1"&gt;# ä¿å­˜æ¼”ç¤ºæ–‡ç¨¿&lt;/span&gt;
&lt;span class="n"&gt;prs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;example_presentation.pptx&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;PPT æ–‡ä»¶å·²åˆ›å»ºæˆåŠŸï¼&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="ç¼–ç¨‹"></category><category term="blog"></category><category term="python"></category><category term="ppt"></category><category term="pptx"></category></entry><entry><title>ä½¿ç”¨ Selenium &amp; webdriverÂ è‡ªåŠ¨åŒ–æµ‹è¯•</title><link href="https://shaodongjun.github.io/posts/2025/02/04/python-selenium-web/" rel="alternate"></link><published>2025-02-04T14:08:00+08:00</published><updated>2025-02-04T14:08:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-02-04:/posts/2025/02/04/python-selenium-web/</id><summary type="html">&lt;p&gt;&lt;strong&gt;Selenium&lt;/strong&gt; æ˜¯ Python ç”Ÿæ€ä¸­æœ€å¼ºå¤§çš„å·¥å…·ä¹‹ä¸€ï¼Œç‰¹åˆ«é€‚åˆå¤„ç†åŠ¨æ€ç½‘é¡µå’Œå¤æ‚ç”¨æˆ·äº¤äº’åœºæ™¯ã€‚æ— è®ºæ˜¯ç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€æ•°æ®æŠ“å–ã€è¿˜æ˜¯ Web â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;strong&gt;Selenium&lt;/strong&gt; æ˜¯ Python ç”Ÿæ€ä¸­æœ€å¼ºå¤§çš„å·¥å…·ä¹‹ä¸€ï¼Œç‰¹åˆ«é€‚åˆå¤„ç†åŠ¨æ€ç½‘é¡µå’Œå¤æ‚ç”¨æˆ·äº¤äº’åœºæ™¯ã€‚æ— è®ºæ˜¯ç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€æ•°æ®æŠ“å–ã€è¿˜æ˜¯ Web&amp;nbsp;çˆ¬è™«ã€ä»»åŠ¡è‡ªåŠ¨åŒ–ï¼ˆå¦‚è¡¨å•æäº¤ã€ç½‘é¡µæˆªå›¾ã€æ•°æ®æŠ“å–ç­‰ï¼‰ï¼Œ&lt;code&gt;Selenium&lt;/code&gt; éƒ½æ˜¯ä¸€ä¸ªä¼˜ç§€çš„é€‰æ‹©ã€‚&lt;/p&gt;
&lt;h2&gt;Selenium&amp;nbsp;çš„ä¸€äº›ä¼˜ç§€ç‰¹æ€§å’Œç”¨é€”ï¼š&lt;/h2&gt;
&lt;hr&gt;
&lt;h2&gt;1.&amp;nbsp;è·¨æµè§ˆå™¨æ”¯æŒ&lt;/h2&gt;
&lt;p&gt;Selenium&amp;nbsp;æ”¯æŒå¤šç§æµè§ˆå™¨ï¼ŒåŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Chrome&lt;/strong&gt;ï¼ˆé€šè¿‡&amp;nbsp;ChromeDriverï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Edge&lt;/strong&gt;ï¼ˆé€šè¿‡&amp;nbsp;EdgeDriverï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Firefox&lt;/strong&gt;ï¼ˆé€šè¿‡&amp;nbsp;GeckoDriverï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Safari&lt;/strong&gt;ï¼ˆé€šè¿‡&amp;nbsp;SafariDriverï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Opera&lt;/strong&gt;&amp;nbsp;ç­‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä½¿å¾— Selenium&amp;nbsp;å¯ä»¥åœ¨ä¸åŒçš„æµè§ˆå™¨ç¯å¢ƒä¸­è¿è¡Œç›¸åŒçš„è„šæœ¬ï¼Œç¡®ä¿å…¼å®¹æ€§ã€‚&lt;/p&gt;
&lt;h2&gt;2.&amp;nbsp;æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€&lt;/h2&gt;
&lt;p&gt;Selenium ä¸ä»…æ”¯æŒ&amp;nbsp;Pythonï¼Œè¿˜æ”¯æŒï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Java&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;JavaScript&amp;nbsp;(Node.js)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;C#&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Ruby&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;span class="caps"&gt;PHP&lt;/span&gt;&amp;nbsp;ç­‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥ä½¿ç”¨è‡ªå·±ç†Ÿæ‚‰çš„è¯­è¨€æ¥ç¼–å†™è‡ªåŠ¨åŒ–è„šæœ¬ã€‚&lt;/p&gt;
&lt;h2&gt;3.&amp;nbsp;å¼ºå¤§çš„å…ƒç´ å®šä½åŠŸèƒ½&lt;/h2&gt;
&lt;p&gt;Selenium&amp;nbsp;æä¾›äº†å¤šç§å®šä½ç½‘é¡µå…ƒç´ çš„æ–¹å¼ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;By &lt;span class="caps"&gt;ID&lt;/span&gt;&lt;/strong&gt;: &lt;code&gt;find_element(By.ID, "element_id")&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;By Class Name&lt;/strong&gt;: &lt;code&gt;find_element(By.CLASS_NAME, "class_name")&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;By Name&lt;/strong&gt;: &lt;code&gt;find_element(By.NAME, "name")&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;By Tag Name&lt;/strong&gt;: &lt;code&gt;find_element(By.TAG_NAME, "tag_name")&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;By &lt;span class="caps"&gt;CSS&lt;/span&gt; Selector&lt;/strong&gt;: &lt;code&gt;find_element(By.CSS_SELECTOR, "css_selector")&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;By XPath&lt;/strong&gt;: &lt;code&gt;find_element(By.XPATH, "xpath_expression")&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™äº›å®šä½æ–¹å¼ä½¿å¾— Selenium&amp;nbsp;å¯ä»¥çµæ´»åœ°ä¸ç½‘é¡µä¸­çš„ä»»ä½•å…ƒç´ äº¤äº’ã€‚&lt;/p&gt;
&lt;h2&gt;4.&amp;nbsp;ä¸°å¯Œçš„æ“ä½œåŠŸèƒ½&lt;/h2&gt;
&lt;p&gt;Selenium&amp;nbsp;ä¸ä»…å¯ä»¥ç‚¹å‡»æŒ‰é’®ã€è¾“å…¥æ–‡æœ¬ï¼Œè¿˜å¯ä»¥ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æäº¤è¡¨å•&lt;/li&gt;
&lt;li&gt;å¤„ç†ä¸‹æ‹‰èœå•&lt;/li&gt;
&lt;li&gt;ä¸Šä¼ æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œ JavaScript&amp;nbsp;ä»£ç &lt;/li&gt;
&lt;li&gt;æˆªå›¾&lt;/li&gt;
&lt;li&gt;å¤„ç†å¼¹çª—ï¼ˆå¦‚è­¦å‘Šæ¡†ã€ç¡®è®¤æ¡†ï¼‰&lt;/li&gt;
&lt;li&gt;åˆ‡æ¢çª—å£æˆ–&amp;nbsp;iframe&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™äº›åŠŸèƒ½ä½¿å¾— Selenium&amp;nbsp;å¯ä»¥æ¨¡æ‹Ÿå‡ ä¹æ‰€æœ‰çš„ç”¨æˆ·æ“ä½œã€‚&lt;/p&gt;
&lt;h2&gt;5.&amp;nbsp;æ”¯æŒåŠ¨æ€ç½‘é¡µ&lt;/h2&gt;
&lt;p&gt;Selenium å¯ä»¥å¤„ç† JavaScript&amp;nbsp;åŠ¨æ€åŠ è½½çš„å†…å®¹ï¼Œè¿™æ˜¯å®ƒä¸ä¼ ç»Ÿçˆ¬è™«å·¥å…·ï¼ˆå¦‚ &lt;code&gt;requests&lt;/code&gt; åº“ï¼‰ç›¸æ¯”çš„æœ€å¤§ä¼˜åŠ¿ã€‚å®ƒèƒ½å¤Ÿç­‰å¾…é¡µé¢å®Œå…¨åŠ è½½åå†è¿›è¡Œæ“ä½œï¼Œç”šè‡³å¯ä»¥ä¸åŠ¨æ€ç”Ÿæˆçš„å…ƒç´ äº¤äº’ã€‚&lt;/p&gt;
&lt;h2&gt;6. æ”¯æŒæ— å¤´æ¨¡å¼ï¼ˆHeadless&amp;nbsp;Modeï¼‰&lt;/h2&gt;
&lt;p&gt;é€šè¿‡å¯ç”¨æ— å¤´æ¨¡å¼ï¼ˆå¦‚ &lt;code&gt;options.add_argument('headless')&lt;/code&gt;ï¼‰ï¼ŒSelenium å¯ä»¥åœ¨åå°è¿è¡Œæµè§ˆå™¨ï¼Œæ— éœ€æ‰“å¼€ &lt;span class="caps"&gt;GUI&lt;/span&gt;&amp;nbsp;ç•Œé¢ã€‚è¿™å¯¹äºæœåŠ¡å™¨ç¯å¢ƒæˆ–è‡ªåŠ¨åŒ–ä»»åŠ¡éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥èŠ‚çœèµ„æºå¹¶æé«˜æ•ˆç‡ã€‚&lt;/p&gt;
&lt;h2&gt;7.&amp;nbsp;å¼ºå¤§çš„ç­‰å¾…æœºåˆ¶&lt;/h2&gt;
&lt;p&gt;Selenium&amp;nbsp;æä¾›äº†ä¸¤ç§ç­‰å¾…æœºåˆ¶æ¥å¤„ç†å¼‚æ­¥åŠ è½½çš„å†…å®¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éšå¼ç­‰å¾…ï¼ˆImplicit Waitï¼‰&lt;/strong&gt;ï¼šå…¨å±€ç­‰å¾…æ—¶é—´ï¼Œé€‚ç”¨äºæ‰€æœ‰å…ƒç´ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;implicitly_wait&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# ç­‰å¾…æœ€å¤š 10 ç§’&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ˜¾å¼ç­‰å¾…ï¼ˆExplicit Waitï¼‰&lt;/strong&gt;ï¼šé’ˆå¯¹ç‰¹å®šæ¡ä»¶ç­‰å¾…ï¼Œç›´åˆ°æ¡ä»¶æ»¡è¶³æˆ–è¶…æ—¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.common.by&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;By&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.support.ui&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;WebDriverWait&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.support&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;expected_conditions&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;EC&lt;/span&gt;

&lt;span class="n"&gt;element&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;WebDriverWait&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;until&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;EC&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;presence_of_element_located&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;By&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ID&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;element_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;8.&amp;nbsp;æ”¯æŒåˆ†å¸ƒå¼æµ‹è¯•&lt;/h2&gt;
&lt;p&gt;é€šè¿‡ Selenium&amp;nbsp;Gridï¼Œå¯ä»¥åœ¨å¤šå°æœºå™¨ä¸Šå¹¶è¡Œè¿è¡Œæµ‹è¯•è„šæœ¬ï¼Œæ˜¾è‘—æé«˜æµ‹è¯•æ•ˆç‡ã€‚&lt;/p&gt;
&lt;h2&gt;9.&amp;nbsp;ç¤¾åŒºæ”¯æŒå’Œæ–‡æ¡£ä¸°å¯Œ&lt;/h2&gt;
&lt;p&gt;Selenium&amp;nbsp;æ‹¥æœ‰åºå¤§çš„ç”¨æˆ·ç¤¾åŒºå’Œä¸°å¯Œçš„æ–‡æ¡£èµ„æºï¼Œé‡åˆ°é—®é¢˜æ—¶å¯ä»¥è½»æ¾æ‰¾åˆ°è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;h2&gt;10.&amp;nbsp;åº”ç”¨åœºæ™¯å¹¿æ³›&lt;/h2&gt;
&lt;p&gt;Selenium&amp;nbsp;ä¸ä»…ç”¨äºæµ‹è¯•ï¼Œè¿˜å¯ä»¥ç”¨äºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Web&amp;nbsp;çˆ¬è™«ï¼šæŠ“å–åŠ¨æ€åŠ è½½çš„æ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è‡ªåŠ¨åŒ–ä»»åŠ¡ï¼šå¦‚è‡ªåŠ¨å¡«å†™è¡¨å•ã€è‡ªåŠ¨ç™»å½•ã€è‡ªåŠ¨ä¸‹è½½æ–‡ä»¶ç­‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç½‘é¡µç›‘æ§ï¼šå®šæœŸæ£€æŸ¥ç½‘é¡µå†…å®¹å˜åŒ–ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ€§èƒ½æµ‹è¯•ï¼šæ¨¡æ‹Ÿç”¨æˆ·æ“ä½œï¼Œæµ‹è¯•ç½‘é¡µæ€§èƒ½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;11.&amp;nbsp;ä¸å…¶ä»–å·¥å…·é›†æˆ&lt;/h2&gt;
&lt;p&gt;Selenium&amp;nbsp;å¯ä»¥ä¸å…¶ä»–å·¥å…·å’Œæ¡†æ¶é›†æˆï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Pytestï¼šç”¨äºç¼–å†™æ›´ç»“æ„åŒ–çš„æµ‹è¯•è„šæœ¬ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;BeautifulSoupï¼šç”¨äºè§£ææŠ“å–çš„ç½‘é¡µå†…å®¹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Pandasï¼šç”¨äºå¤„ç†å’Œåˆ†ææŠ“å–çš„æ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Dockerï¼šç”¨äºåœ¨å®¹å™¨åŒ–ç¯å¢ƒä¸­è¿è¡Œ&amp;nbsp;Seleniumã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;12.&amp;nbsp;å¼€æºå’Œå…è´¹&lt;/h2&gt;
&lt;p&gt;Selenium&amp;nbsp;æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå®Œå…¨å…è´¹ä½¿ç”¨ï¼Œé€‚åˆä¸ªäººå’Œä¼ä¸šã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1&gt;ä½¿ç”¨Selenium v4&amp;nbsp;ç¼–å†™è„šæœ¬&lt;/h1&gt;
&lt;h2&gt;é¢„çº¦çƒåœº&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.common.by&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;By&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.edge.service&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Service&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.edge.options&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Options&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.support.ui&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;WebDriverWait&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.support&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;expected_conditions&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;EC&lt;/span&gt;

&lt;span class="c1"&gt;# è®¾ç½® Edge é€‰é¡¹&lt;/span&gt;
&lt;span class="n"&gt;options&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Options&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;use_chromium&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;  &lt;span class="c1"&gt;# This is required for Selenium 4&lt;/span&gt;
&lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;headless&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# è¿è¡Œæ— ç•Œé¢æ¨¡å¼&lt;/span&gt;
&lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--disable-gpu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# å¯é€‰ï¼šç¦ç”¨ GPU ç¡¬ä»¶åŠ é€Ÿ&lt;/span&gt;
&lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--window-size=1920,1080&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# å¯é€‰ï¼šè®¾ç½®çª—å£å¤§å°&lt;/span&gt;

&lt;span class="c1"&gt;# åˆå§‹åŒ– WebDriver æœåŠ¡&lt;/span&gt;
&lt;span class="n"&gt;service&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Service&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;executable_path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;C:\chromedriver.exe&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;driver&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;day&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;days&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;daytime&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;today&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timedelta&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;days&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;day&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timetuple&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;daytime&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mktime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;daytime&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;https://xihuwenti.juyancn.cn/wechat/product/details?id=753&amp;amp;time=&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;daytime&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;

        &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="c1"&gt;# ç­‰å¾…å…ƒç´ åŠ è½½&lt;/span&gt;
        &lt;span class="n"&gt;elems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;WebDriverWait&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;until&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="n"&gt;EC&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;presence_of_all_elements_located&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;By&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CLASS_NAME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;can-select&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;start_time&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data-start&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;end_time&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data-end&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;start_time&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;12:00&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;end_time&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;18:00&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;hall_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data-hall_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;day&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hall_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;start_time&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end_time&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="k"&gt;raise&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;quit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="ç¼–ç¨‹"></category><category term="blog"></category><category term="python"></category><category term="selenium"></category><category term="web"></category></entry><entry><title>ä½¿ç”¨ BeautifulSoup &amp; RequestsÂ è§£æç½‘é¡µ</title><link href="https://shaodongjun.github.io/posts/2025/02/03/python-bs4-requests/" rel="alternate"></link><published>2025-02-03T15:53:00+08:00</published><updated>2025-02-03T15:53:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-02-03:/posts/2025/02/03/python-bs4-requests/</id><summary type="html">&lt;p&gt;Pythonæœ‰ä¸¤ä¸ªå¾ˆå¥½ç”¨ç¬¬ä¸‰æ–¹æ¨¡å—&lt;code&gt;requests&lt;/code&gt;åº“å’Œ&lt;code&gt;beautifulsoup&lt;/code&gt;åº“ï¼Œç®€å•å­¦ä¹ ä¸‹æ¨¡å—ç”¨æ³•ï¼š&lt;/p&gt;
&lt;h2&gt;requestsæ¨¡å—&lt;/h2&gt;
&lt;p&gt;æ ‡å‡†åº“ä¸­æä¾›äº†ï¼š&lt;strong&gt;urllibã€urllib2ã€httplib&lt;/strong&gt; ç­‰æ¨¡å—ä»¥ä¾›Httpè¯·æ±‚ï¼Œä½¿ç”¨èµ·æ¥è¾ƒä¸ºéº»çƒ¦ã€‚
&lt;a href="https://requests.readthedocs.io"&gt;requests&lt;/a&gt;æ˜¯åŸºäºPythonå¼€å‘çš„HTTPç¬¬ä¸‰æ–¹åº“ï¼Œåœ¨Pythonå†…ç½®æ¨¡å—çš„åŸºç¡€ä¸Šè¿›è¡Œäº†é«˜åº¦çš„å°è£…ï¼Œä½¿ç”¨äº† â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;Pythonæœ‰ä¸¤ä¸ªå¾ˆå¥½ç”¨ç¬¬ä¸‰æ–¹æ¨¡å—&lt;code&gt;requests&lt;/code&gt;åº“å’Œ&lt;code&gt;beautifulsoup&lt;/code&gt;åº“ï¼Œç®€å•å­¦ä¹ ä¸‹æ¨¡å—ç”¨æ³•ï¼š&lt;/p&gt;
&lt;h2&gt;requestsæ¨¡å—&lt;/h2&gt;
&lt;p&gt;æ ‡å‡†åº“ä¸­æä¾›äº†ï¼š&lt;strong&gt;urllibã€urllib2ã€httplib&lt;/strong&gt; ç­‰æ¨¡å—ä»¥ä¾›Httpè¯·æ±‚ï¼Œä½¿ç”¨èµ·æ¥è¾ƒä¸ºéº»çƒ¦ã€‚
&lt;a href="https://requests.readthedocs.io"&gt;requests&lt;/a&gt;æ˜¯åŸºäºPythonå¼€å‘çš„HTTPç¬¬ä¸‰æ–¹åº“ï¼Œåœ¨Pythonå†…ç½®æ¨¡å—çš„åŸºç¡€ä¸Šè¿›è¡Œäº†é«˜åº¦çš„å°è£…ï¼Œä½¿ç”¨äº†æ›´ç®€å•ï¼Œä»£ç é‡æ›´å°‘ã€‚&lt;/p&gt;
&lt;h3&gt;requests&amp;nbsp;çš„apiä¸»è¦åŒ…æ‹¬äº†å…«ä¸ªæ–¹æ³•ï¼š&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;options&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;post&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;put&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;patch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;delete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

&lt;span class="c1"&gt;#ä¸Šé¢æ–¹æ³•éƒ½æ˜¯åŸºäºrequestæ–¹æ³•å®ç°çš„ï¼ˆmethodå‚æ•°ï¼‰&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;BeautifulSoupæ¨¡å—&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;BeautifulSoup&lt;/code&gt;æ¨¡å—æ˜¯ä¸€ä¸ªå¯ä»¥ä» &lt;strong&gt;HTMLæˆ–XML&lt;/strong&gt; æ–‡ä»¶ä¸­æå–æ•°æ®çš„Pythonç¬¬ä¸‰æ–¹åº“ã€‚&amp;nbsp;å®ƒå°†ä¸€ä¸ªhtmlæˆ–xmlå­—ç¬¦ä¸²ï¼ˆæˆ–æ–‡æ¡£å¥æŸ„ï¼‰æ–‡æ¡£è¢«è½¬æ¢æˆUnicodeï¼Œåˆ©ç”¨è§£æå™¨æ¥è§£æè¿™æ®µæ–‡æ¡£ã€‚&lt;/p&gt;
&lt;h3&gt;BeautifulSoup&amp;nbsp;æ”¯æŒå‡ ç§ä¸åŒçš„è§£æå™¨ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;pythonæ ‡å‡†åº“ä¸­çš„html.parser&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¬¬ä¸‰æ–¹åº“lxml-html&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;lxml-xml&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;html5lib&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="beautifulsoup" src="/images/beautifulsoup-parser.png"&gt;&lt;/p&gt;
&lt;h2&gt;çˆ¬è™«åº”ç”¨:&amp;nbsp;é¢„çº¦ç©ºé—²çš„ç¾½æ¯›çƒé¦†æ—¶é—´&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;rq&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;bs4&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;BeautifulSoup&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;bs&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;datetime&lt;/span&gt;
&lt;span class="n"&gt;debug&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;place&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;753&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;   &lt;span class="c1"&gt;# ç¾½æ¯›çƒåœºåœ°ç¼–å·&lt;/span&gt;
&lt;span class="n"&gt;days&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;          &lt;span class="c1"&gt;# æ£€æŸ¥è¿‘3å¤©çš„ç©ºé—²æ—¶é—´&lt;/span&gt;

&lt;span class="n"&gt;headers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;User-Agent&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;id&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;place&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;day&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;days&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;daytime&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;today&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timedelta&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;day&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strftime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;https://xihuwenti.juyancn.cn/wechat/product/details?id=&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="nb"&gt;id&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;amp;time=&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;daytime&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rq&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;soup&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;lxml&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;soup&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;li&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;class&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;can-select&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data-start&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;12:00&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data-start&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;18:00&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data-hall_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;, &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data-start&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;,&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data-end&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;è¿”å›æŸ¥è¯¢ç»“æœ&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;https://xihuwenti.juyancn.cn/wechat/product/details?id=753&amp;amp;time=1738598400
1å·åœº, 12:00,13:00
2å·åœº, 12:00,13:00
https://xihuwenti.juyancn.cn/wechat/product/details?id=753&amp;amp;time=1738684800
1å·åœº, 12:00,13:00
3å·åœº, 12:00,13:00
5å·åœº, 18:00,20:00
6å·åœº, 18:00,20:00
https://xihuwenti.juyancn.cn/wechat/product/details?id=753&amp;amp;time=1738771200
2å·åœº, 12:00,13:00
5å·åœº, 12:00,13:00
6å·åœº, 12:00,13:00
1å·åœº, 18:00,20:00
2å·åœº, 18:00,20:00
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="ç¼–ç¨‹"></category><category term="blog"></category><category term="python"></category><category term="requests"></category><category term="beautifulsoup"></category><category term="bs"></category><category term="web"></category></entry><entry><title>ä½¿ç”¨ PandasÂ å®ç°åŸºæœ¬çš„æ•°æ®åˆ†æ</title><link href="https://shaodongjun.github.io/posts/2025/02/02/python-pandas/" rel="alternate"></link><published>2025-02-02T10:16:00+08:00</published><updated>2025-02-02T10:16:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-02-02:/posts/2025/02/02/python-pandas/</id><summary type="html">&lt;p&gt;&lt;strong&gt;Pandas&lt;/strong&gt; ä¸€ä¸ªå¼ºå¤§çš„åˆ†æç»“æ„åŒ–æ•°æ®çš„å·¥å…·é›†ï¼ŒåŸºç¡€æ˜¯ &lt;a href="https://www.runoob.com/numpy/numpy-tutorial.html"&gt;Numpy&lt;/a&gt;ï¼ˆæä¾›é«˜æ€§èƒ½çš„çŸ©é˜µè¿ç®—ï¼‰ã€‚&lt;/p&gt;
&lt;h2&gt;æ•°æ®ç»“æ„&lt;/h2&gt;
&lt;p&gt;Pandas çš„ä¸»è¦æ•°æ®ç»“æ„æ˜¯ Series ï¼ˆä¸€ç»´æ•°æ®ï¼‰ä¸ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;strong&gt;Pandas&lt;/strong&gt; ä¸€ä¸ªå¼ºå¤§çš„åˆ†æç»“æ„åŒ–æ•°æ®çš„å·¥å…·é›†ï¼ŒåŸºç¡€æ˜¯ &lt;a href="https://www.runoob.com/numpy/numpy-tutorial.html"&gt;Numpy&lt;/a&gt;ï¼ˆæä¾›é«˜æ€§èƒ½çš„çŸ©é˜µè¿ç®—ï¼‰ã€‚&lt;/p&gt;
&lt;h2&gt;æ•°æ®ç»“æ„&lt;/h2&gt;
&lt;p&gt;Pandas çš„ä¸»è¦æ•°æ®ç»“æ„æ˜¯ Series ï¼ˆä¸€ç»´æ•°æ®ï¼‰ä¸&amp;nbsp;DataFrameï¼ˆäºŒç»´æ•°æ®ï¼‰ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Series æ˜¯ä¸€ç§ç±»ä¼¼äºä¸€ç»´æ•°ç»„çš„å¯¹è±¡ï¼Œå®ƒç”±ä¸€ç»„æ•°æ®ï¼ˆå„ç§ Numpy æ•°æ®ç±»å‹ï¼‰ä»¥åŠä¸€ç»„ä¸ä¹‹ç›¸å…³çš„æ•°æ®æ ‡ç­¾ï¼ˆå³ç´¢å¼•ï¼‰ç»„æˆã€‚
&lt;img alt="serier" src="/images/pandas-series.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DataFrame æ˜¯ä¸€ä¸ªè¡¨æ ¼å‹çš„æ•°æ®ç»“æ„ï¼Œå®ƒå«æœ‰ä¸€ç»„æœ‰åºçš„åˆ—ï¼Œæ¯åˆ—å¯ä»¥æ˜¯ä¸åŒçš„å€¼ç±»å‹ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å‹å€¼ï¼‰ã€‚DataFrame æ—¢æœ‰è¡Œç´¢å¼•ä¹Ÿæœ‰åˆ—ç´¢å¼•ï¼Œå®ƒå¯ä»¥è¢«çœ‹åšç”± Series ç»„æˆçš„å­—å…¸ï¼ˆå…±åŒç”¨ä¸€ä¸ªç´¢å¼•ï¼‰ã€‚
&lt;img alt="dataframe" src="/images/pandas-dataframe.png"&gt;
&lt;img alt="dataframe" src="/images/pandas-df2.png"&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Pandas&amp;nbsp;åº”ç”¨&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Pandas å¯ä»¥ä»å„ç§æ–‡ä»¶æ ¼å¼æ¯”å¦‚ &lt;span class="caps"&gt;CSV&lt;/span&gt;ã€&lt;span class="caps"&gt;JSON&lt;/span&gt;ã€&lt;span class="caps"&gt;SQL&lt;/span&gt;ã€Microsoft Excel&amp;nbsp;å¯¼å…¥æ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Pandas&amp;nbsp;å¯ä»¥å¯¹å„ç§æ•°æ®è¿›è¡Œè¿ç®—æ“ä½œï¼Œæ¯”å¦‚å½’å¹¶ã€å†æˆå½¢ã€é€‰æ‹©ï¼Œè¿˜æœ‰æ•°æ®æ¸…æ´—å’Œæ•°æ®åŠ å·¥ç‰¹å¾ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Pandas&amp;nbsp;å¹¿æ³›åº”ç”¨åœ¨å­¦æœ¯ã€é‡‘èã€ç»Ÿè®¡å­¦ç­‰å„ä¸ªæ•°æ®åˆ†æé¢†åŸŸã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Pandas&amp;nbsp;åŠŸèƒ½&lt;/h2&gt;
&lt;p&gt;Pandas&amp;nbsp;æ˜¯æ•°æ®åˆ†æçš„åˆ©å™¨ï¼Œå®ƒä¸ä»…æä¾›äº†é«˜æ•ˆã€çµæ´»çš„æ•°æ®ç»“æ„ï¼Œè¿˜èƒ½å¸®åŠ©ä½ ä»¥æä½çš„æˆæœ¬å®Œæˆå¤æ‚çš„æ•°æ®æ“ä½œå’Œåˆ†æä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;Pandas&amp;nbsp;æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ•°æ®æ¸…æ´—ï¼šå¤„ç†ç¼ºå¤±æ•°æ®ã€é‡å¤æ•°æ®ç­‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ•°æ®è½¬æ¢ï¼šæ”¹å˜æ•°æ®çš„å½¢çŠ¶ã€ç»“æ„æˆ–æ ¼å¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ•°æ®åˆ†æï¼šè¿›è¡Œç»Ÿè®¡åˆ†æã€èšåˆã€åˆ†ç»„ç­‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ•°æ®å¯è§†åŒ–ï¼šé€šè¿‡æ•´åˆ Matplotlib å’Œ Seaborn&amp;nbsp;ç­‰åº“ï¼Œå¯ä»¥è¿›è¡Œæ•°æ®å¯è§†åŒ–ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Pandas æ˜¯ Python&lt;/strong&gt;&amp;nbsp;æ•°æ®ç§‘å­¦é¢†åŸŸä¸­ä¸å¯æˆ–ç¼ºçš„å·¥å…·ä¹‹ä¸€ï¼Œå®ƒçš„çµæ´»æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ä½¿å¾—æ•°æ®å¤„ç†å’Œåˆ†æå˜å¾—æ›´åŠ ç®€å•å’Œé«˜æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;å¯è¿è¡Œçš„ä»£ç å®ä¾‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;

&lt;span class="c1"&gt;# ä¸­æ–‡æ”¯æŒï¼Œä¸ä¼šæ˜¾ç¤ºå°æ–¹æ¡†&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;font.sans-serif&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SimHei&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Songti SC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;STFangsong&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# æ­£å¸¸æ˜¾ç¤ºè´Ÿå·&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;axes.unicode_minus&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
&lt;span class="c1"&gt;# è®¾ç½®çº¿æ¡å®½åº¦&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;lines.linewidth&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;
&lt;span class="c1"&gt;# è®¾ç½®çº¿æ¡é¢œè‰²&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;lines.color&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;red&amp;#39;&lt;/span&gt;
&lt;span class="c1"&gt;# è®¾ç½®çº¿æ¡æ ·å¼ï¼Œæ ·å¼çš„å„ç±»è¿˜æœ‰ `--`ä¸ºè™šçº¿ï¼Œ`-.`ä¸ºç‚¹è™šçº¿&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;lines.linestyle&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;--&amp;#39;&lt;/span&gt; &lt;span class="c1"&gt;# ç›´çº¿&lt;/span&gt;

&lt;span class="c1"&gt;# 1. åˆ›å»ºä¸€ä¸ªç¤ºä¾‹ DataFrame&lt;/span&gt;
&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;Name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;å¼ ä¸‰&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;æå››&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ç‹äº”&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;èµµå…­&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ç”°ä¸ƒ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;Age&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;24&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;29&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;Salary&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8500&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6800&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6500&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;Department&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;HR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;IT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Finance&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;IT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;HR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# 2. æ•°æ®æŸ¥çœ‹&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;DataFrame: &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# 3. åŸºæœ¬ç»Ÿè®¡&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;åŸºæœ¬ç»Ÿè®¡: &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;describe&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# 4. æ•°æ®é€‰æ‹©&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;é€‰æ‹© &amp;#39;Name&amp;#39; å’Œ &amp;#39;Salary&amp;#39; åˆ—: &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Salary&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# 5. æ·»åŠ æ–°åˆ—&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Bonus&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Salary&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æ·»åŠ  &amp;#39;Bonus&amp;#39; åˆ—: &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# 6. æ¡ä»¶ç­›é€‰&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ç­›é€‰å‡ºè–ªæ°´å¤§äº 6000 çš„å‘˜å·¥: &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Salary&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;6000&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# 7. åˆ†ç»„ç»Ÿè®¡&lt;/span&gt;
&lt;span class="n"&gt;grouped&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;groupby&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Department&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numeric_only&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# åªè®¡ç®—æ•°å€¼åˆ—&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æŒ‰éƒ¨é—¨åˆ†ç»„çš„å¹³å‡å€¼: &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;grouped&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# 8. å¤„ç†ç¼ºå¤±å€¼&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Salary&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;  &lt;span class="c1"&gt;# äººä¸ºåˆ¶é€ ç¼ºå¤±å€¼&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;å¤„ç†ç¼ºå¤±å€¼: &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fillna&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Salary&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# 9. æ•°æ®æ’åº&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æŒ‰å¹´é¾„æ’åº: &lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort_values&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Age&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# 10. æ•°æ®å¯è§†åŒ–&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;å§“å&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;è–ªèµ„&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;å‘˜å·¥è–ªæ°´&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Salary&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blue&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="ç¼–ç¨‹"></category><category term="blog"></category><category term="python"></category><category term="pandas"></category><category term="excel"></category><category term="xls"></category><category term="xlsx"></category></entry><entry><title>ä½¿ç”¨ PIL(pillow) å®ç°å›¾ç‰‡ç»˜åˆ¶ &amp; è£å‰ª &amp;Â æ°´å°</title><link href="https://shaodongjun.github.io/posts/2025/02/01/python-pillow-pil/" rel="alternate"></link><published>2025-02-01T20:32:00+08:00</published><updated>2025-02-01T20:32:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-02-01:/posts/2025/02/01/python-pillow-pil/</id><summary type="html">&lt;p&gt;ä½¿ç”¨&lt;code&gt;PIL&lt;/code&gt;ä»£ç å®ç°äº†ä»å›¾åƒä¸­è£å‰ªå‡ºä¸€ä¸ª&lt;code&gt;logo&lt;/code&gt;ï¼Œå¹¶å°†å…¶ä½œä¸ºæ°´å°æ·»åŠ åˆ°å…¶ä»–å›¾åƒä¸Šã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PIL&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PIL&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ImageDraw&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pathlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt;

&lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/Users/apple â€¦&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;ä½¿ç”¨&lt;code&gt;PIL&lt;/code&gt;ä»£ç å®ç°äº†ä»å›¾åƒä¸­è£å‰ªå‡ºä¸€ä¸ª&lt;code&gt;logo&lt;/code&gt;ï¼Œå¹¶å°†å…¶ä½œä¸ºæ°´å°æ·»åŠ åˆ°å…¶ä»–å›¾åƒä¸Šã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PIL&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PIL&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ImageDraw&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pathlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt;

&lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/Users/apple/myDemo/Python39_Demos/image&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;infile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;test0.png&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;watermark&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;../logo.png&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# è¿™é‡Œä¿®å¤äº†è·¯å¾„&lt;/span&gt;
&lt;span class="n"&gt;margin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;crop_logo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;infile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;outfile&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;pyimg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;infile&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;width&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pyimg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;width&lt;/span&gt;
        &lt;span class="n"&gt;height&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pyimg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;height&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;å›¾åƒçš„é«˜å’Œå®½: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;height&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;, &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;width&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;logo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pyimg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;crop&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;150&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;150&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;logo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;outfile&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;è£å‰ª Logo æ—¶å‡ºé”™: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;img_watermark&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;infile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;waterfile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;outfile&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;logo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;waterfile&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;infile&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;width&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;logo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;width&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;margin&lt;/span&gt;
        &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;height&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;logo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;height&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;margin&lt;/span&gt;

        &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;paste&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;logo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;  &lt;span class="c1"&gt;# ä½¿ç”¨ logo ä½œä¸ºæ©ç &lt;/span&gt;
        &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;outfile&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æ·»åŠ æ°´å°æ—¶å‡ºé”™: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;draw_logo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;outfile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;python&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;RGBA&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;400&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;400&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;white&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;pen&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ImageDraw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Draw&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;pen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;point&lt;/span&gt;&lt;span class="p"&gt;([(&lt;/span&gt;&lt;span class="mi"&gt;190&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;210&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;)],&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;pen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;([(&lt;/span&gt;&lt;span class="mi"&gt;180&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;180&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;220&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;180&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;220&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;220&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;180&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;220&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;180&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;180&lt;/span&gt;&lt;span class="p"&gt;)],&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;pen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rectangle&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;250&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;250&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;pen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;150&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;150&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;outfile&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# è£å‰ª Logo&lt;/span&gt;
&lt;span class="n"&gt;crop_logo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;infile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;watermark&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# ç»˜åˆ¶ Logo&lt;/span&gt;
&lt;span class="n"&gt;draw_logo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;watermark&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# éå† PNG æ–‡ä»¶å¹¶æ·»åŠ æ°´å°&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rglob&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;*.png&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stem&lt;/span&gt;
    &lt;span class="n"&gt;outfile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;_mark.png&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;img_watermark&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;watermark&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;outfile&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;ä»£ç åˆ†æ&lt;/h2&gt;
&lt;h3&gt;è£å‰ª&amp;nbsp;Logoï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;crop_logo å‡½æ•°ä»è¾“å…¥å›¾åƒä¸­è£å‰ªå‡ºä¸€ä¸ª 100x100&amp;nbsp;åƒç´ çš„åŒºåŸŸï¼Œå¹¶å°†å…¶ä¿å­˜ä¸ºæ°´å°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;æ·»åŠ æ°´å°ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;img_watermark å‡½æ•°å°†è£å‰ªå‡ºçš„ logo&amp;nbsp;ä½œä¸ºæ°´å°æ·»åŠ åˆ°æŒ‡å®šçš„å›¾åƒä¸Šï¼Œæ”¾ç½®åœ¨å³ä¸‹è§’ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ç»˜åˆ¶&amp;nbsp;Logoï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;draw_logo å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ 400x400 åƒç´ çš„å›¾åƒï¼Œåœ¨å…¶ä¸­ç»˜åˆ¶äº†ä¸€äº›å›¾å½¢å’Œæ–‡æœ¬ï¼Œå¹¶ä¿å­˜ä¸º logo&amp;nbsp;å›¾åƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;éå† &lt;span class="caps"&gt;PNG&lt;/span&gt;&amp;nbsp;æ–‡ä»¶ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ Path.rglob() æ–¹æ³•æŸ¥æ‰¾æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰ &lt;span class="caps"&gt;PNG&lt;/span&gt;&amp;nbsp;æ–‡ä»¶ï¼Œå¹¶å¯¹æ¯ä¸ªæ–‡ä»¶åº”ç”¨æ°´å°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;æ”¹è¿›å»ºè®®&lt;/h2&gt;
&lt;h3&gt;è·¯å¾„å¤„ç†ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ os.path.join()&amp;nbsp;ä»¥ç¡®ä¿è·¯å¾„åœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¸Šå…¼å®¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;å¼‚å¸¸å¤„ç†ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¯ä»¥åœ¨æ‰“å¼€å’Œä¿å­˜å›¾åƒæ—¶æ·»åŠ å¼‚å¸¸å¤„ç†ï¼Œä»¥é¿å…åœ¨æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ— æ³•å†™å…¥æ—¶å´©æºƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;å‚æ•°åŒ–ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è€ƒè™‘å°†æŸäº›å‚æ•°ï¼ˆå¦‚è£å‰ªåŒºåŸŸã€å›¾åƒå¤§å°ç­‰ï¼‰ä½œä¸ºå‡½æ•°å‚æ•°ï¼Œä»¥æé«˜çµæ´»æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;</content><category term="ç¼–ç¨‹"></category><category term="blog"></category><category term="python"></category><category term="pillow"></category><category term="pil"></category></entry><entry><title>ä½¿ç”¨ PyPDF å’Œ PandocÂ å®ç°word/pdfè½¬æ¢</title><link href="https://shaodongjun.github.io/posts/2025/02/01/python-pypdf-pandoc/" rel="alternate"></link><published>2025-02-01T15:04:00+08:00</published><updated>2025-02-01T15:04:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-02-01:/posts/2025/02/01/python-pypdf-pandoc/</id><summary type="html">&lt;p&gt;ä»£ç ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ &lt;code&gt;PyPDF&lt;/code&gt; å’Œ &lt;code&gt;Pandoc&lt;/code&gt; å®ç°word/pdfè½¬æ¢&lt;/p&gt;
&lt;p&gt;å…³äº&lt;a href="https://medium.com/@daneallist/3-simple-ways-to-merge-word-documents-using-python-862112ff4152"&gt;Pandocçš„å…·ä½“ç”¨æ³•&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pypandoc&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;convert_file&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pathlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyPDF2&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;PdfReader&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;PdfWriter&lt;/span&gt; 
&lt;span class="n"&gt;unused&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;~&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;demo&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;find_doc_files&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;docx&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;dir&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rglob&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f â€¦&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;ä»£ç ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ &lt;code&gt;PyPDF&lt;/code&gt; å’Œ &lt;code&gt;Pandoc&lt;/code&gt; å®ç°word/pdfè½¬æ¢&lt;/p&gt;
&lt;p&gt;å…³äº&lt;a href="https://medium.com/@daneallist/3-simple-ways-to-merge-word-documents-using-python-862112ff4152"&gt;Pandocçš„å…·ä½“ç”¨æ³•&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pypandoc&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;convert_file&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pathlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyPDF2&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;PdfReader&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;PdfWriter&lt;/span&gt; 
&lt;span class="n"&gt;unused&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;~&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;demo&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;find_doc_files&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;docx&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;dir&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rglob&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;*.&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
             &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;startswith&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;unused&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;convert_pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;infile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;outfile&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;convert_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;infile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;outfile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="n"&gt;extra_args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--pdf-engine=weasyprint&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add_watermark&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;infile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;watermark&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;outfile&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;old_file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;PdfReader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;infile&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;new_file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;PdfWriter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;pageNum&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;old_file&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pages&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;old_file&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pages&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pageNum&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;merge_page&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;watermark&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;new_file&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_page&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;outfile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;wb&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;new_file&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;watermark_file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;PdfReader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;watermark.pdf&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;watermark&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;watermark_file&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pages&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

    &lt;span class="n"&gt;file_list&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;find_doc_files&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;docx&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;file_list&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stem&lt;/span&gt;
        &lt;span class="n"&gt;convert_pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;.pdf&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;add_watermark&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;watermark&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;_mark.pdf&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;ä»£ç åˆ†æ&lt;/h2&gt;
&lt;h3&gt;æŸ¥æ‰¾ docx&amp;nbsp;æ–‡ä»¶ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;find_doc_files å‡½æ•°ä½¿ç”¨ Path.rglob æ–¹æ³•é€’å½’æŸ¥æ‰¾æŒ‡å®šç›®å½•ä¸­çš„ &lt;span class="caps"&gt;DOCX&lt;/span&gt; æ–‡ä»¶ï¼Œæ’é™¤ä»¥ unused&amp;nbsp;å…ƒç»„ä¸­æŒ‡å®šçš„å‰ç¼€å¼€å¤´çš„æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;&lt;span class="caps"&gt;PDF&lt;/span&gt;&amp;nbsp;è½¬æ¢ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;convert_pdf å‡½æ•°ä½¿ç”¨ pypandoc çš„ convert_file æ–¹æ³•å°† docx æ–‡ä»¶è½¬æ¢ä¸º &lt;span class="caps"&gt;PDF&lt;/span&gt;ï¼Œä½¿ç”¨ WeasyPrint ä½œä¸º &lt;span class="caps"&gt;PDF&lt;/span&gt;&amp;nbsp;å¼•æ“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;æ·»åŠ æ°´å°ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;add_watermark å‡½æ•°è¯»å–è¾“å…¥ &lt;span class="caps"&gt;PDF&lt;/span&gt;ï¼Œä½¿ç”¨ PyPDF2&amp;nbsp;å°†æ°´å°æ·»åŠ åˆ°æ¯ä¸€é¡µï¼Œå¹¶ä¿å­˜ä¸ºæ–°æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;æ³¨æ„äº‹é¡¹&lt;/h2&gt;
&lt;h3&gt;ä¾èµ–åº“å®‰è£…ï¼š&lt;/h3&gt;
&lt;p&gt;ç¡®ä¿å·²å®‰è£… pypandocã€PyPDF2 å’Œ&amp;nbsp;WeasyPrintã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;pip&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;pypandoc&lt;span class="w"&gt; &lt;/span&gt;PyPDF2&lt;span class="w"&gt; &lt;/span&gt;WeasyPrint
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="ç¼–ç¨‹"></category><category term="blog"></category><category term="python"></category><category term="word"></category><category term="pdf"></category><category term="pypdf"></category><category term="pandoc"></category></entry><entry><title>ä½¿ç”¨ python-docx åˆ›å»º wordÂ æ–‡ä»¶</title><link href="https://shaodongjun.github.io/posts/2025/02/01/python-pydocx/" rel="alternate"></link><published>2025-02-01T10:52:00+08:00</published><updated>2025-02-01T10:52:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-02-01:/posts/2025/02/01/python-pydocx/</id><summary type="html">&lt;p&gt;ä»£ç ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ &lt;code&gt;python-docx&lt;/code&gt; åº“åˆ›å»ºå’Œä¿®æ”¹ Word&amp;nbsp;æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h2&gt;å¯è¿è¡Œä»£ç &lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;docx&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Document&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;docx.oxml.ns&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;qn&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;docx.shared&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Pt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;RGBColor&lt;/span&gt; 

&lt;span class="n"&gt;template&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;demo.docx&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;name_placeholder&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;lt;name&amp;gt;&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;sex_placeholder&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;lt;sex â€¦&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;ä»£ç ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ &lt;code&gt;python-docx&lt;/code&gt; åº“åˆ›å»ºå’Œä¿®æ”¹ Word&amp;nbsp;æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h2&gt;å¯è¿è¡Œä»£ç &lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;docx&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Document&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;docx.oxml.ns&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;qn&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;docx.shared&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Pt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;RGBColor&lt;/span&gt; 

&lt;span class="n"&gt;template&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;demo.docx&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;name_placeholder&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;lt;name&amp;gt;&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;sex_placeholder&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;lt;sex&amp;gt;&amp;quot;&lt;/span&gt; 

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;new_doc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;demo.docx&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;doc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Document&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="c1"&gt;# è®¾ç½® Normal æ ·å¼&lt;/span&gt;
    &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;styles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Normal&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;font&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PingFang&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;styles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Normal&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_element&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rPr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rFonts&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;qn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;w:eastAsia&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;PingFang&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 
    &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;styles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Normal&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;font&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rgb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;RGBColor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;styles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Normal&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;font&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Pt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# æ·»åŠ æ ‡é¢˜å’Œæ®µè½&lt;/span&gt;
    &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_heading&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;æ®µè½æ ‡é¢˜:  æ¬¢è¿! &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;name_placeholder&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt; (&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;sex_placeholder&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;) &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_paragraph&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;æ®µè½æ­£æ–‡: &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ç²—ä½“&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bold&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
    &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39; and some &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;æ–œä½“.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;italic&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;

    &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_heading&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ä¸€çº§æ ‡é¢˜ï¼š Heading, level 1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_paragraph&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;å¼•ç”¨æ®µè½ï¼šIntense quote&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Intense Quote&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_paragraph&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;first item in unordered list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;List Bullet&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_paragraph&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;first item in ordered list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;List Number&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# æ·»åŠ å›¾ç‰‡&lt;/span&gt;
    &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_picture&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test0.png&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;width&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Inches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="c1"&gt;# æ·»åŠ è¡¨æ ¼&lt;/span&gt;
    &lt;span class="n"&gt;records&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;101&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;åœŸè±†&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;422&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;é¸¡è›‹&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;631&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;è¥¿çº¢æŸ¿&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;table&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cols&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;hdr_cells&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cells&lt;/span&gt;
    &lt;span class="n"&gt;hdr_cells&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;æ•°é‡&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;hdr_cells&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Id&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;hdr_cells&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;æè¿°&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;qty&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;desc&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;records&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;row_cells&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_row&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cells&lt;/span&gt;
        &lt;span class="n"&gt;row_cells&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;qty&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;row_cells&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;id&lt;/span&gt;
        &lt;span class="n"&gt;row_cells&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;desc&lt;/span&gt;

    &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_page_break&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;invite&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sex&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;doc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Document&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;para&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;paragraphs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;para&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;runs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;name_placeholder&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name_placeholder&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;sex_placeholder&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;sex&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;å…ˆç”Ÿ&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;sex&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ç”·&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;å¥³å£«&amp;quot;&lt;/span&gt;
                &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sex_placeholder&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sex&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;.docx&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# åˆ›å»ºæ–°æ–‡æ¡£å¹¶æ›¿æ¢å ä½ç¬¦&lt;/span&gt;
&lt;span class="n"&gt;new_doc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;invite&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ä¸œä¿Š&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ç”·&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="ç¼–ç¨‹"></category><category term="blog"></category><category term="python"></category><category term="doc"></category><category term="docx"></category></entry><entry><title>ä½¿ç”¨ openpyxl åˆ›å»º ExcelÂ æ–‡ä»¶</title><link href="https://shaodongjun.github.io/posts/2025/01/31/python-openpyxl/" rel="alternate"></link><published>2025-01-31T18:00:00+08:00</published><updated>2025-01-31T18:00:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-01-31:/posts/2025/01/31/python-openpyxl/</id><summary type="html">&lt;p&gt;ä»£ç ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ &lt;code&gt;openpyxl&lt;/code&gt; åº“ä»æ–‡æœ¬æ–‡ä»¶ä¸­è¯»å–æ•°æ®å¹¶å°†å…¶å†™å…¥Excelæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h2&gt;å¯è¿è¡Œä»£ç &lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;openpyxl&lt;/span&gt;

&lt;span class="c1"&gt;# åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œç°¿&lt;/span&gt;
&lt;span class="n"&gt;wb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;openpyxl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Workbook&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# åˆ›å»º â€¦&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;ä»£ç ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ &lt;code&gt;openpyxl&lt;/code&gt; åº“ä»æ–‡æœ¬æ–‡ä»¶ä¸­è¯»å–æ•°æ®å¹¶å°†å…¶å†™å…¥Excelæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h2&gt;å¯è¿è¡Œä»£ç &lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;openpyxl&lt;/span&gt;

&lt;span class="c1"&gt;# åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œç°¿&lt;/span&gt;
&lt;span class="n"&gt;wb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;openpyxl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Workbook&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# åˆ›å»ºä¸€ä¸ªå·¥ä½œè¡¨å¹¶å‘½åä¸º &amp;quot;äººå‘˜åå•&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;wt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;wb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create_sheet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;äººå‘˜åå•&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# ä»æ–‡æœ¬æ–‡ä»¶è¯»å–æ•°æ®å¹¶å†™å…¥å·¥ä½œè¡¨&lt;/span&gt;
&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;memo.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readlines&lt;/span&gt;&lt;span class="p"&gt;()):&lt;/span&gt;
        &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;  &lt;span class="c1"&gt;# Excel è¡Œä» 1 å¼€å§‹&lt;/span&gt;
        &lt;span class="n"&gt;people&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;,&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;people&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="c1"&gt;# ç¡®ä¿è‡³å°‘æœ‰ä¸¤ä¸ªå…ƒç´ &lt;/span&gt;
            &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;people&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="n"&gt;sex&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;people&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="n"&gt;wt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;column&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;wt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;column&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;sex&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;wb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æµ‹è¯•åå•.xlsx&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;ä»£ç è§£é‡Š&lt;/h2&gt;
&lt;h3&gt;åˆ›å»ºå·¥ä½œç°¿å’Œå·¥ä½œè¡¨ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ openpyxl.Workbook()&amp;nbsp;åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œç°¿ã€‚&lt;/li&gt;
&lt;li&gt;create_sheet(&amp;#8220;äººå‘˜åå•&amp;#8221;, 0) åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œè¡¨å¹¶å°†å…¶å‘½åä¸º&amp;nbsp;&amp;#8220;äººå‘˜åå•&amp;#8221;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;è¯»å–æ–‡ä»¶ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ‰“å¼€æ–‡æœ¬æ–‡ä»¶ï¼Œç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ç¼–ç ï¼ˆå¦‚ &lt;span class="caps"&gt;UTF&lt;/span&gt;-8ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;enumerate(f.readlines())&amp;nbsp;ç”¨äºé€è¡Œè¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¹¶åœ¨å¾ªç¯ä¸­è·å¾—è¡Œç´¢å¼•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;å¤„ç†æ•°æ®ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ strip().split(&amp;#8220;,&amp;#8221;)&amp;nbsp;å»é™¤è¡Œé¦–å°¾ç©ºç™½å¹¶æ ¹æ®é€—å·åˆ†éš”å­—ç¬¦ä¸²ã€‚&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥ people&amp;nbsp;åˆ—è¡¨çš„é•¿åº¦ï¼Œç¡®ä¿è‡³å°‘æœ‰ä¸¤ä¸ªå…ƒç´ ï¼ˆå§“åå’Œæ€§åˆ«ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;å†™å…¥å·¥ä½œè¡¨ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ wt.cell(row=row, column=1, value=name)&amp;nbsp;å°†å§“åå†™å…¥ç¬¬ä¸€åˆ—ï¼Œæ€§åˆ«å†™å…¥ç¬¬äºŒåˆ—ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ä¿å­˜æ–‡ä»¶ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ wb.save(&amp;#8220;æµ‹è¯•åå•.xlsx&amp;#8221;)&amp;nbsp;ä¿å­˜å·¥ä½œç°¿ã€‚&lt;/li&gt;
&lt;li&gt;æ³¨æ„ï¼Œopenpyxl æ”¯æŒ .xlsx æ ¼å¼ï¼Œè€Œä¸æ˜¯&amp;nbsp;.xlsã€‚&lt;/li&gt;
&lt;/ul&gt;</content><category term="ç¼–ç¨‹"></category><category term="blog"></category><category term="python"></category><category term="xls"></category><category term="xlsx"></category><category term="openpyxl"></category><category term="excel"></category></entry><entry><title>My firstÂ post</title><link href="https://shaodongjun.github.io/posts/2025/01/31/misc-first-post/" rel="alternate"></link><published>2025-01-31T12:00:00+08:00</published><updated>2025-01-31T12:00:00+08:00</updated><author><name>DJ.shao</name></author><id>tag:shaodongjun.github.io,2025-01-31:/posts/2025/01/31/misc-first-post/</id><content type="html">&lt;h5&gt;å¼€ç¯‡å°è®°&lt;/h5&gt;
&lt;p&gt;ä»Šå¤©æ˜¯ä¸ªå¥½æ—¥å­ï¼&lt;/p&gt;
&lt;p&gt;This is the &lt;em&gt;first post&lt;/em&gt; by Pelican Blog. &lt;strong&gt;&lt;span class="caps"&gt;YAY&lt;/span&gt;!&lt;/strong&gt;&lt;/p&gt;</content><category term="æ‚è®°"></category><category term="blog"></category><category term="misc"></category><category term="pelican"></category></entry></feed>
